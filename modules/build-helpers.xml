<?xml version="1.0" encoding="UTF-8"?>
<project name="build-helpers" >
    <description>
            This file contains common helper targets and is included from build.xml
    </description>

	<target name="showtime" >
		<tstamp>
			<format property="currenttime" pattern="yyyy-MM-dd HH:mm:ss Z"/>
		</tstamp>
		<echo message="Current time is ${currenttime}."/>
	</target>
	
	<target name="ejbca-cli" depends="ejbca-ejb-cli">
		<fail message="ejbca-cli.arg is not set." unless="ejbca-cli.arg" />
		<fail message="ejbca-ejb-cli.jar was never built">
			<condition><not><available file="${mod.ejbca-ejb-cli.lib}"/></not></condition>
		</fail>
		<echo message="Executing EJBCA CLI with arguments: ${ejbca-cli.arg}"/>
		<java dir="${ejbca.home}" jar="${ejbca.home}/dist/ejbca-ejb-cli/ejbca-ejb-cli.jar" fork="true">
			<arg line="${ejbca-cli.arg}"/>
		</java>
	</target>

	<target name="createreport">
		<fail message="'reports.dir' is not set." unless="reports.dir" />
		<junitreport todir="${reports.dir}">
			<fileset dir="${reports.dir}">
				<include name="TEST-*.xml" />
			</fileset>
			<report format="frames" todir="${reports.dir}/html" />
		</junitreport>
    	<echo message=""/>
    	<echo message="Results are available in file://${reports.dir}/html/index.html"/>
	</target>
</project>
