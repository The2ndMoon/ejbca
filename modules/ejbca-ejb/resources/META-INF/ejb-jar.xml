<?xml version="1.0" encoding="UTF-8"?>
<ejb-jar version="3.0"
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/ejb-jar_3_0.xsd"
    >

    <!--
        This file is required for mapping
        - the EjbcaDS DataSource JNDI name to "java:comp/env/DataSource" (@Resource injection using mappedName is appserver specific.)
        - CustomAvailableAccessRules
        - randomAlgorithm
        
        TODO:
        - Read values of "CustomAvailableAccessRules" and "randomAlgorithm" through Commons Configuration instead.
        - Review if all these SSBs really use DataSources.
        - Replace JDBC access with JPA Queries and drop injection of DataSources.
    -->

    <enterprise-beans>
        <session>
            <ejb-name>RSASignSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.ca.sign.RSASignSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>randomAlgorithm</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value>SHA1PRNG</env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalAuthorizationSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.authorization.LocalAuthorizationSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
            <env-entry>
                <description>Custom Available Access Rules, use ';' to separate multiple accessrules></description>
                <env-entry-name>CustomAvailableAccessRules</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>CAAdminSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.ca.caadmin.CAAdminSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>UpgradeSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.upgrade.UpgradeSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalCertificateStoreSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.ca.store.LocalCertificateStoreSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalServiceSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.services.LocalServiceSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalApprovalSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.approval.LocalApprovalSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalLogSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.log.LocalLogSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalKeyRecoverySessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.keyrecovery.LocalKeyRecoverySessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalUserDataSourceSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.ra.userdatasource.LocalUserDataSourceSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalCertificateStoreOnlyDataSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.ca.store.LocalCertificateStoreOnlyDataSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalHardTokenSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.hardtoken.LocalHardTokenSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>ProtectedLogSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.log.ProtectedLogSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>PublisherQueueSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.ca.publisher.PublisherQueueSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>ServiceTimerSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.services.ServiceTimerSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalEjbcaHardTokenBatchJobSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.hardtoken.LocalEjbcaHardTokenBatchJobSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalUserAdminSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.ra.LocalUserAdminSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>LocalCertificateRequestSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.ra.LocalCertificateRequestSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>CreateCRLSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.ca.crl.CreateCRLSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
        <session>
            <ejb-name>OldLogSessionBean</ejb-name>
            <ejb-class>org.ejbca.core.ejb.log.OldLogSessionBean</ejb-class>
            <env-entry>
                <env-entry-name>DataSource</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value><![CDATA[${datasource.jndi-name-prefix}${datasource.jndi-name}]]></env-entry-value>
            </env-entry>
        </session>
    </enterprise-beans>
</ejb-jar>
