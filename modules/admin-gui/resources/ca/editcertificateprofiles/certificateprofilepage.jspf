<%@ page import="org.cesecore.certificates.ca.catoken.CATokenConstants, java.text.MessageFormat"%>
<%
  CertificateProfile cpd = cabean.getEditableCP(cp);
  CertificateExtensionFactory certExtFact = CertificateExtensionFactory.getInstance();
 
  String[] SUPERADMIN_TYPE_NAMES = {"ENDENTITY", "SUBCA", "ROOTCA"};
  int[] SUPERADMIN_TYPE_IDS = cabean.getSuperAdminTypeIDs();
  String[] TYPE_NAMES = {"ENDENTITY"};
  int[] TYPE_IDS = {CertificateConstants.CERTTYPE_ENDENTITY};
  if (issuperadministrator) {
    TYPE_NAMES = SUPERADMIN_TYPE_NAMES;
    TYPE_IDS = SUPERADMIN_TYPE_IDS;
  }
  Collection authorizedcas = cabean.getAuthorizedCAs();
  Map caidtonamemap = cabean.getCAIdToNameMap();
  TreeMap authorizedpublishers = ejbcawebbean.getInformationMemory().getAuthorizedPublisherNames();
  Map publisheridtonamemap = ejbcawebbean.getInformationMemory().getPublisherIdToNameMap();

  int row = 0;
%>
<script type="text/javascript">
<!--  

function checkusefield(usefield, criticalfield){
  var usebox = eval("document.editcp." + usefield);
  var cribox = eval("document.editcp." + criticalfield);
  if(usebox.checked){
    cribox.disabled = false;
  }
  else{
    cribox.checked=false;
    cribox.disabled = true;
  }
}

function checkusecrldisturifield(){
  if(document.editcp.<%=CB_CRLDISTRIBUTIONPOINT %>.checked){
    document.editcp.<%= CB_CRLDISTRIBUTIONPOINTCRITICAL %>.disabled = false;
    document.editcp.<%= CB_USEDEFAULTCRLDISTRIBUTIONPOINT %>.disabled = false;
    document.editcp.<%= CB_USEDEFAULTCRLDISTRIBUTIONPOINT %>.checked = true;
  }
  else{
    document.editcp.<%= CB_CRLDISTRIBUTIONPOINTCRITICAL %>.disabled = true;
    document.editcp.<%= CB_CRLDISTRIBUTIONPOINTCRITICAL %>.checked = false;
    document.editcp.<%= CB_USEDEFAULTCRLDISTRIBUTIONPOINT %>.disabled = true;
    document.editcp.<%= CB_USEDEFAULTCRLDISTRIBUTIONPOINT %>.checked = false;
    document.editcp.<%= TEXTFIELD_CRLDISTURI %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CRLDISTURI %>.value = "";   
    document.editcp.<%= TEXTFIELD_CRLISSUER %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CRLISSUER %>.value = "";   
  }

}

function checkusedefaultsecrldisturifield(){
  if(!document.editcp.<%=CB_USEDEFAULTCRLDISTRIBUTIONPOINT %>.checked){
    document.editcp.<%= TEXTFIELD_CRLDISTURI %>.disabled = false;
    document.editcp.<%= TEXTFIELD_CRLDISTURI %>.value = "<%= globalconfiguration.getStandardCRLDistributionPointURI() %>";
    document.editcp.<%= TEXTFIELD_CRLISSUER %>.disabled = false;
    document.editcp.<%= TEXTFIELD_CRLISSUER %>.value = "<%= globalconfiguration.getStandardCRLIssuer() %>";
  }
  else{
    document.editcp.<%= TEXTFIELD_CRLDISTURI %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CRLDISTURI %>.value = "";
    document.editcp.<%= TEXTFIELD_CRLISSUER %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CRLISSUER %>.value = "";
  }

}

function checkusefreshestcrlfield(){
  if(document.editcp.<%=CB_USEFRESHESTCRL %>.checked){
    document.editcp.<%= CB_USECADEFINEDFRESHESTCRL %>.disabled = false;
    document.editcp.<%= CB_USECADEFINEDFRESHESTCRL %>.checked = true;
  }
  else{
  	document.editcp.<%= CB_USECADEFINEDFRESHESTCRL %>.disabled = true;
    document.editcp.<%= CB_USECADEFINEDFRESHESTCRL %>.checked = false;
    document.editcp.<%= TEXTFIELD_FRESHESTCRLURI %>.disabled = true;
    document.editcp.<%= TEXTFIELD_FRESHESTCRLURI %>.value = "";
  }
}

function checkusecadefinedfreshestcrlfield(){
  if(document.editcp.<%=CB_USECADEFINEDFRESHESTCRL %>.checked){
  	document.editcp.<%= TEXTFIELD_FRESHESTCRLURI %>.disabled = true;
    document.editcp.<%= TEXTFIELD_FRESHESTCRLURI %>.value = "";
  }
  else{
    document.editcp.<%= TEXTFIELD_FRESHESTCRLURI %>.disabled = false;
    document.editcp.<%= TEXTFIELD_FRESHESTCRLURI %>.value = "<%= globalconfiguration.getStandardDeltaCRLDistributionPointURI() %>";
  }
}

function checkuseaiafield(caIssuersURIcount){
  if(document.editcp.<%=CB_USEAUTHORITYINFORMATIONACCESS %>.checked){    
    document.editcp.<%= CB_USEDEFAULTOCSPSERVICELOCALTOR %>.disabled = false;
    document.editcp.<%= CB_USEDEFAULTOCSPSERVICELOCALTOR %>.checked = true;
    document.editcp.<%= TEXTFIELD_OCSPSERVICELOCATOR %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CAISSUERURI %>.disabled = false;
    document.editcp.<%= TEXTFIELD_CAISSUERURI %>.value = "";
    document.editcp.<%= BUTTON_ADD_CAISSUERURI %>.disabled = false;
    // For already defined caIssuers URIs
    for (var i = 0; i < caIssuersURIcount; i++) {
      eval("document.editcp.<%= TEXTFIELD_CAISSUERURI %>" + i + ".disabled = false");
      eval("document.editcp.<%= BUTTON_DELETE_CAISSUERURI %>" + i + ".disabled = false");
    }
  }
  else{
    document.editcp.<%= CB_USEDEFAULTOCSPSERVICELOCALTOR %>.disabled = true;
    document.editcp.<%= CB_USEDEFAULTOCSPSERVICELOCALTOR %>.checked = false;
    document.editcp.<%= TEXTFIELD_OCSPSERVICELOCATOR %>.disabled = true;
    document.editcp.<%= TEXTFIELD_OCSPSERVICELOCATOR %>.value = "";
    document.editcp.<%= TEXTFIELD_CAISSUERURI %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CAISSUERURI %>.value = "";
    document.editcp.<%= BUTTON_ADD_CAISSUERURI %>.disabled = true;
    // For already defined caIssuers URIs
    for (var i = 0; i < caIssuersURIcount; i++) {
      eval("document.editcp.<%= TEXTFIELD_CAISSUERURI %>" + i + ".disabled = true");
      eval("document.editcp.<%= BUTTON_DELETE_CAISSUERURI %>" + i + ".disabled = true");
    }
  }
}

function checkdefaultocspservicelocatorfield(){
  if(!document.editcp.<%=CB_USEDEFAULTOCSPSERVICELOCALTOR %>.checked){    
    document.editcp.<%= TEXTFIELD_OCSPSERVICELOCATOR %>.disabled = false;
    document.editcp.<%= TEXTFIELD_OCSPSERVICELOCATOR %>.value = "<%= globalconfiguration.getStandardOCSPServiceLocatorURI() %>";
  }
  else{
    document.editcp.<%= TEXTFIELD_OCSPSERVICELOCATOR %>.disabled = true;
    document.editcp.<%= TEXTFIELD_OCSPSERVICELOCATOR %>.value = "";
  }
}

function checkuseqcstatementfield(){
  if(document.editcp.<%=CB_USEQCSTATEMENT %>.checked){    
    document.editcp.<%= CB_QCSTATEMENTCRITICAL %>.disabled = false;
    document.editcp.<%= TEXTFIELD_QCSSEMANTICSID %>.disabled = false;
    document.editcp.<%= TEXTFIELD_QCSTATEMENTRANAME %>.disabled = false;
    document.editcp.<%= CB_USEPKIXQCSYNTAXV2 %>.disabled = false;
    document.editcp.<%= CB_USEQCETSIQCCOMPLIANCE %>.disabled = false;
    document.editcp.<%= CB_USEQCETSIVALUELIMIT %>.disabled = false;
    document.editcp.<%= CB_USEQCETSIRETENTIONPERIOD %>.disabled = false;
    document.editcp.<%= CB_USEQCETSISIGNATUREDEVICE %>.disabled = false;
    document.editcp.<%= CB_USEQCCUSTOMSTRING %>.disabled = false;
  }
  else{
    document.editcp.<%= CB_QCSTATEMENTCRITICAL %>.disabled = true;
    document.editcp.<%= CB_QCSTATEMENTCRITICAL %>.checked = false;
    document.editcp.<%= TEXTFIELD_QCSSEMANTICSID %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCSTATEMENTRANAME %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCSSEMANTICSID %>.value = "";
    document.editcp.<%= TEXTFIELD_QCSTATEMENTRANAME %>.value = "";
    document.editcp.<%= CB_USEPKIXQCSYNTAXV2 %>.disabled = true;
    document.editcp.<%= CB_USEPKIXQCSYNTAXV2 %>.checked = false;
    document.editcp.<%= CB_USEQCETSIQCCOMPLIANCE %>.disabled = true;
    document.editcp.<%= CB_USEQCETSIQCCOMPLIANCE %>.checked = false;
    document.editcp.<%= CB_USEQCETSIVALUELIMIT %>.disabled = true;
    document.editcp.<%= CB_USEQCETSIVALUELIMIT %>.checked = false;
    document.editcp.<%= CB_USEQCETSIRETENTIONPERIOD %>.disabled = true;
    document.editcp.<%= CB_USEQCETSIRETENTIONPERIOD %>.checked = false;
    document.editcp.<%= CB_USEQCETSISIGNATUREDEVICE %>.disabled = true;
    document.editcp.<%= CB_USEQCETSISIGNATUREDEVICE %>.checked = false;
    document.editcp.<%= CB_USEQCCUSTOMSTRING %>.disabled = true;
    document.editcp.<%= CB_USEQCCUSTOMSTRING %>.checked = false;
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMIT %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITEXP %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITCUR %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMIT %>.value = "";
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITEXP %>.value = "";
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITCUR %>.value = "";
    document.editcp.<%= TEXTFIELD_QCETSIRETENTIONPERIOD %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCETSIRETENTIONPERIOD %>.value = "";
    document.editcp.<%= TEXTFIELD_QCCUSTOMSTRINGOID %>.value = "";
    document.editcp.<%= TEXTFIELD_QCCUSTOMSTRINGTEXT %>.value = "";
  }
}

function checkusecertificatetransparencyfield(){
  if(document.editcp.<%=CB_USECERTIFICATETRANSPARENCYINCERTS %>.checked ||
     document.editcp.<%=CB_USECERTIFICATETRANSPARENCYINOCSP %>.checked){
    document.editcp.<%= SELECT_CTLOGS %>.disabled = false;
    document.editcp.<%= TEXTFIELD_CTMINSCTS %>.disabled = false;
    document.editcp.<%= TEXTFIELD_CTMINSCTS %>.value = <%=cpd.getCTMinSCTs()%>;
    document.editcp.<%= TEXTFIELD_CTMAXSCTS %>.disabled = false;
    document.editcp.<%= TEXTFIELD_CTMAXSCTS %>.value = <%=cpd.getCTMaxSCTs()%>;
    document.editcp.<%= TEXTFIELD_CTMAXRETRIES %>.disabled = false;
    document.editcp.<%= TEXTFIELD_CTMAXRETRIES %>.value = <%=cpd.getCTMaxRetries()%>;

  }
  else{
    document.editcp.<%= SELECT_CTLOGS %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CTMINSCTS %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CTMINSCTS %>.value = "";
    document.editcp.<%= TEXTFIELD_CTMAXSCTS %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CTMAXSCTS %>.value = "";
    document.editcp.<%= TEXTFIELD_CTMAXRETRIES %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CTMAXRETRIES %>.value = "";
  }
}

function checkuseetsivaluelimitfield(){
  if(document.editcp.<%=CB_USEQCETSIVALUELIMIT %>.checked){    
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMIT %>.disabled = false;
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITEXP %>.disabled = false;
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITCUR %>.disabled = false;
  }
  else{
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMIT %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITEXP %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITCUR %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMIT %>.value = "";
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITEXP %>.value = "";
    document.editcp.<%= TEXTFIELD_QCETSIVALUELIMITCUR %>.value = "";
  }
}

function checkusetsiretentionperiod(){
  if(document.editcp.<%=CB_USEQCETSIRETENTIONPERIOD %>.checked){
    document.editcp.<%= TEXTFIELD_QCETSIRETENTIONPERIOD %>.disabled = false;
  }
  else{
    document.editcp.<%= TEXTFIELD_QCETSIRETENTIONPERIOD %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCETSIRETENTIONPERIOD %>.value = "";
  }
}

function checkuseqccustomstring(){
  if(document.editcp.<%=CB_USEQCCUSTOMSTRING %>.checked){    
    document.editcp.<%= TEXTFIELD_QCCUSTOMSTRINGOID %>.disabled = false;
    document.editcp.<%= TEXTFIELD_QCCUSTOMSTRINGTEXT %>.disabled = false;
  }
  else{
    document.editcp.<%= TEXTFIELD_QCCUSTOMSTRINGOID %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCCUSTOMSTRINGTEXT %>.disabled = true;
    document.editcp.<%= TEXTFIELD_QCCUSTOMSTRINGOID %>.value = "";
    document.editcp.<%= TEXTFIELD_QCCUSTOMSTRINGTEXT %>.value = "";
  }
}

function checkusemstemplatefield(){
  if(document.editcp.<%=CB_USEMSTEMPLATE %>.checked){    
    document.editcp.<%= SELECT_MSTEMPLATE %>.disabled = false;    
  }
  else{
    document.editcp.<%= SELECT_MSTEMPLATE %>.disabled = true;
  }
}

function checkusecnpostfixfield(){
  if(document.editcp.<%=CB_USECNPOSTFIX %>.checked){    
    document.editcp.<%= TEXTFIELD_CNPOSTFIX %>.disabled = false;    
  }
  else{
    document.editcp.<%= TEXTFIELD_CNPOSTFIX %>.disabled = true;
  }
}

function checkusesubjectdnsubsetfield(){
  if(document.editcp.<%=CB_USESUBJECTDNSUBSET %>.checked){    
    document.editcp.<%= SELECT_SUBJECTDNSUBSET %>.disabled = false;    
  }
  else{
    document.editcp.<%= SELECT_SUBJECTDNSUBSET %>.disabled = true;
  }
}

function checkusesubjectaltnamesubsetfield(){
  if(document.editcp.<%=CB_USESUBJECTALTNAMESUBSET %>.checked){    
    document.editcp.<%=SELECT_SUBJECTALTNAMESUBSET%>.disabled = false;    
  }
  else{
    document.editcp.<%=SELECT_SUBJECTALTNAMESUBSET%>.disabled = true;
  }
}

function typechanged(){
  var seltype = document.editcp.<%=SELECT_TYPE %>.options.selectedIndex;
  var type = document.editcp.<%=SELECT_TYPE %>.options[seltype].value; 

  if (type == <%= CertificateConstants.CERTTYPE_ENDENTITY %>) {
    document.editcp.<%=SELECT_AVAILABLEPUBLISHERS %>.disabled=false;
    document.editcp.<%=CB_USEPATHLENGTHCONSTRAINT %>.disabled=true;
    document.editcp.<%=CB_USEPATHLENGTHCONSTRAINT %>.checked=false;
    document.editcp.<%=TEXTFIELD_PATHLENGTHCONSTRAINT %>.disabled=true;
    document.editcp.<%=TEXTFIELD_PATHLENGTHCONSTRAINT %>.value="";
  } else {
    document.editcp.<%=SELECT_AVAILABLEPUBLISHERS %>.disabled=true;
    if(document.editcp.<%=CB_BASICCONSTRAINTS %>.checked){    
      document.editcp.<%=CB_USEPATHLENGTHCONSTRAINT %>.disabled=false;
    }
  }
}

function checkusebasicconstraintfield(){
  if(document.editcp.<%=CB_BASICCONSTRAINTS %>.checked){
    document.editcp.<%= CB_BASICCONSTRAINTSCRITICAL %>.disabled = false;
    
    var seltype = document.editcp.<%=SELECT_TYPE %>.options.selectedIndex;
    var type = document.editcp.<%=SELECT_TYPE %>.options[seltype].value; 
    if (type == <%= CertificateConstants.CERTTYPE_SUBCA %> ||
    	type == <%= CertificateConstants.CERTTYPE_ROOTCA %>) {
      document.editcp.<%=CB_USEPATHLENGTHCONSTRAINT %>.disabled=false;
    }          
  }
  else{
    document.editcp.<%= CB_BASICCONSTRAINTSCRITICAL %>.disabled = true;
    document.editcp.<%= CB_BASICCONSTRAINTSCRITICAL %>.checked = false;
    document.editcp.<%= CB_USEPATHLENGTHCONSTRAINT %>.disabled = true;
    document.editcp.<%= CB_USEPATHLENGTHCONSTRAINT %>.checked = false;
    document.editcp.<%= TEXTFIELD_PATHLENGTHCONSTRAINT %>.disabled=true;
    document.editcp.<%= TEXTFIELD_PATHLENGTHCONSTRAINT %>.value="";
  }
}

function checkusedocumenttypefield(){
	if(document.editcp.<%=CB_USEDOCUMENTTYPE %>.checked){
		document.editcp.<%= CB_DOCUMENTTYPECRITICAL %>.disabled = false;
	    document.editcp.<%= TEXTFIELD_DOCUMENTTYPE %>.disabled = false;
	} else{
	    document.editcp.<%= CB_DOCUMENTTYPECRITICAL %>.disabled = true;
	    document.editcp.<%= TEXTFIELD_DOCUMENTTYPE %>.disabled = true;
	}
}


function checkusecertificatepoliciesfield(policyCount){
  if(document.editcp.<%=CB_USECERTIFICATEPOLICIES %>.checked){
    document.editcp.<%= CB_CERTIFICATEPOLICIESCRITICAL %>.disabled = false;
    document.editcp.<%= TEXTFIELD_CERTIFICATEPOLICYID %>.disabled = false;
    document.editcp.<%= TEXTAREA_POLICYNOTICE_UNOTICE %>.disabled = false;
    document.editcp.<%= TEXTFIELD_POLICYNOTICE_CPSURL %>.disabled = false;
    document.editcp.<%= BUTTON_ADD_POLICY %>.disabled = false;
    // For already defined policies
    for (var i = 0; i < policyCount; i++) {
      eval("document.editcp.<%= TEXTFIELD_CERTIFICATEPOLICYID %>" + i + ".disabled = false");
      eval("document.editcp.<%= TEXTAREA_POLICYNOTICE_UNOTICE %>" + i + ".disabled = false");
      eval("document.editcp.<%= TEXTFIELD_POLICYNOTICE_CPSURL %>" + i + ".disabled = false");
      eval("document.editcp.<%= BUTTON_DELETE_POLICY %>" + i + ".disabled = false");
    }
  }
  else{
    document.editcp.<%= CB_CERTIFICATEPOLICIESCRITICAL %>.disabled = true;
    document.editcp.<%= CB_CERTIFICATEPOLICIESCRITICAL %>.checked = false;
    document.editcp.<%= TEXTFIELD_CERTIFICATEPOLICYID %>.disabled = true;
    document.editcp.<%= TEXTFIELD_CERTIFICATEPOLICYID %>.value = "";
    document.editcp.<%= TEXTAREA_POLICYNOTICE_UNOTICE %>.disabled = true;
    document.editcp.<%= TEXTAREA_POLICYNOTICE_UNOTICE %>.value = "";
    document.editcp.<%= TEXTFIELD_POLICYNOTICE_CPSURL %>.disabled = true;
    document.editcp.<%= TEXTFIELD_POLICYNOTICE_CPSURL %>.value = "";
    document.editcp.<%= BUTTON_ADD_POLICY %>.disabled = true;
    // For already defined policies
    for (var i = 0; i < policyCount; i++) {
      eval("document.editcp.<%= TEXTFIELD_CERTIFICATEPOLICYID %>" + i + ".disabled = true");
      eval("document.editcp.<%= TEXTAREA_POLICYNOTICE_UNOTICE %>" + i + ".disabled = true");
      eval("document.editcp.<%= TEXTFIELD_POLICYNOTICE_CPSURL %>" + i + ".disabled = true");
      eval("document.editcp.<%= BUTTON_DELETE_POLICY %>" + i + ".disabled = true");
    }
  }
}

function checkusepathlengtconstraintfield(){
  if(document.editcp.<%=CB_USEPATHLENGTHCONSTRAINT %>.checked){  
    document.editcp.<%= TEXTFIELD_PATHLENGTHCONSTRAINT %>.disabled = false;
    document.editcp.<%= TEXTFIELD_PATHLENGTHCONSTRAINT %>.value = "1";
  }
  else{
    document.editcp.<%= TEXTFIELD_PATHLENGTHCONSTRAINT %>.disabled = true;
    document.editcp.<%= TEXTFIELD_PATHLENGTHCONSTRAINT %>.value = "";
  }
}

function checkusekeyusagefield(){
  if(document.editcp.<%=CB_KEYUSAGE %>.checked){
    document.editcp.<%= CB_KEYUSAGECRITICAL %>.disabled = false;
    document.editcp.<%= SELECT_KEYUSAGE %>.disabled = false;
  }
  else{
    document.editcp.<%= CB_KEYUSAGECRITICAL %>.disabled = true;
    document.editcp.<%= CB_KEYUSAGECRITICAL %>.checked = false;
    document.editcp.<%= SELECT_KEYUSAGE %>.disabled = true;
  }
}

function checkuseextendedkeyusagefield(){
  if(document.editcp.<%=CB_USEEXTENDEDKEYUSAGE %>.checked){
    document.editcp.<%= CB_EXTENDEDKEYUSAGECRITICAL %>.disabled = false;
    document.editcp.<%= SELECT_EXTENDEDKEYUSAGE %>.disabled = false;
  }
  else{
    document.editcp.<%= CB_EXTENDEDKEYUSAGECRITICAL %>.disabled = true;
    document.editcp.<%= CB_EXTENDEDKEYUSAGECRITICAL %>.checked = false;
    document.editcp.<%= SELECT_EXTENDEDKEYUSAGE %>.disabled = true;
  }
}

function checkprivkeyusageperiodnotbeforefield() {
  if (document.editcp.<%=CB_USEPRIVKEYUSAGEPERIODNOTBEFORE%>.checked) {
    document.editcp.<%= TEXTFIELD_PRIVKEYUSAGEPERIODSTARTOFFSET %>.disabled = false;
    document.editcp.<%= TEXTFIELD_PRIVKEYUSAGEPERIODSTARTOFFSET %>.value = "0d";
  }
  else{
    document.editcp.<%= TEXTFIELD_PRIVKEYUSAGEPERIODSTARTOFFSET %>.disabled = true;
    document.editcp.<%= TEXTFIELD_PRIVKEYUSAGEPERIODSTARTOFFSET %>.value = "";
  }
}
function checkprivkeyusageperiodnotafterfield() {
  if (document.editcp.<%=CB_USEPRIVKEYUSAGEPERIODNOTAFTER%>.checked) {
    document.editcp.<%= TEXTFIELD_PRIVKEYUSAGEPERIODLENGTH %>.disabled = false;
    document.editcp.<%= TEXTFIELD_PRIVKEYUSAGEPERIODLENGTH %>.value = document.editcp.<%= TEXTFIELD_VALIDITY %>.value;
  }
  else{
    document.editcp.<%= TEXTFIELD_PRIVKEYUSAGEPERIODLENGTH %>.disabled = true;
    document.editcp.<%= TEXTFIELD_PRIVKEYUSAGEPERIODLENGTH %>.value = "";
  }
}

// stores hidden options
var cvctermtype_is = [];
var cvctermtype_at = [];
var cvctermtype_st = [];
function cvctermtypechanged() {
  var termtype = document.editcp.<%= SELECT_CVCTERMTYPE %>.value;
  var selectbox = document.editcp.<%=SELECT_CVCACCESSRIGHTS%>;
  
  document.editcp.<%=SELECT_CVCSIGNTERMDVTYPE%>.disabled = (termtype != <%= CertificateProfile.CVC_TERMTYPE_ST %>);
  
  // Add options for the selected terminal type
  var addopts;
  if (termtype == <%= CertificateProfile.CVC_TERMTYPE_IS %>) addopts = cvctermtype_is;
  if (termtype == <%= CertificateProfile.CVC_TERMTYPE_AT %>) addopts = cvctermtype_at;
  if (termtype == <%= CertificateProfile.CVC_TERMTYPE_ST %>) addopts = cvctermtype_st;
  for (var i = 0; i < addopts.length; i++) {
    selectbox.appendChild(addopts[i]);
  }
  
  if (termtype == <%= CertificateProfile.CVC_TERMTYPE_IS %>) cvctermtype_is = [];
  if (termtype == <%= CertificateProfile.CVC_TERMTYPE_AT %>) cvctermtype_at = [];
  if (termtype == <%= CertificateProfile.CVC_TERMTYPE_ST %>) cvctermtype_st = [];
  
  // Hide options for the other terminal types
  var opts = selectbox.options;
  var remove_objs = []; // avoid changing the list while iterating
  for (var i = 0; i < opts.length; i++) {
    var cl = opts[i].className;
    if (cl == "cvcoption_header") {
      // remove the IS/AT/ST headers when javascript is enabled
      remove_objs.push(opts[i]);
    } else if (cl == "cvcoption_is" && termtype != <%= CertificateProfile.CVC_TERMTYPE_IS %>) {
      // move from document to plain array
      cvctermtype_is.push(opts[i]);
      remove_objs.push(opts[i]);
    } else if (cl == "cvcoption_at" && termtype != <%= CertificateProfile.CVC_TERMTYPE_AT %>) {
      cvctermtype_at.push(opts[i]);
      remove_objs.push(opts[i]);
    } else if (cl == "cvcoption_st" && termtype != <%= CertificateProfile.CVC_TERMTYPE_ST %>) {
      cvctermtype_st.push(opts[i]);
      remove_objs.push(opts[i]);
    }
  }
  for (var i = 0; i < remove_objs.length; i++) {
    selectbox.removeChild(remove_objs[i]);
  }
  
  //selectbox.size = Math.min(selectbox.options.length+1, 8);
}

function checkallfields(){
    var illegalfields = 0;

    var availablebitlengths = document.editcp.<%= SELECT_AVAILABLEBITLENGTHS%>.options;
    var selected = 0;
    for(var i=0; i < availablebitlengths.length; i++){
      if(availablebitlengths[i].selected==true)
        selected++; 
    }
    
    if(selected == 0){
      alert("<%=  ejbcawebbean.getText("ONEAVAILABLEBITLENGTH", true) %>");
      illegalfields++; 
    }

    if(!document.editcp.<%=TEXTFIELD_PATHLENGTHCONSTRAINT%>.disabled){
      if(!checkfieldfordecimalnumbers("document.editcp.<%=TEXTFIELD_PATHLENGTHCONSTRAINT%>","<%= ejbcawebbean.getText("ONLYDECNUMBERSINPATHLEN") %>")){
         illegalfields++;
      }    
      if(document.editcp.<%=TEXTFIELD_PATHLENGTHCONSTRAINT%>.value==""){
         alert("<%= ejbcawebbean.getText("PATHLENCANNOTBEEMPTY", true) %>");
         illegalfields++;
      }
    }

    if(!document.editcp.<%=TEXTFIELD_QCETSIVALUELIMIT%>.disabled){
      if(!checkfieldfordecimalnumbers("document.editcp.<%=TEXTFIELD_QCETSIVALUELIMIT%>","<%= ejbcawebbean.getText("ONLYDECINETSIVALUELIMIT") %>")){
         illegalfields++;
      }    
      if(document.editcp.<%=TEXTFIELD_QCETSIVALUELIMIT%>.value==""){
         alert("<%= ejbcawebbean.getText("ETSIVALUELIMCANNOTBEEMPTY", true) %>");
         illegalfields++;
      }
    }

    if(!document.editcp.<%=TEXTFIELD_QCETSIRETENTIONPERIOD%>.disabled){
      if(!checkfieldfordecimalnumbers("document.editcp.<%=TEXTFIELD_QCETSIRETENTIONPERIOD%>","<%= ejbcawebbean.getText("ONLYDECINETSIRETPERIOD") %>")){
         illegalfields++;
      }    
      if(document.editcp.<%=TEXTFIELD_QCETSIRETENTIONPERIOD%>.value==""){
         alert("<%= ejbcawebbean.getText("ETSIRETPERIODCANNOTBEEMPTY", true) %>");
         illegalfields++;
      }
    }
    
    if(!document.editcp.<%=TEXTFIELD_QCETSIVALUELIMITEXP%>.disabled){
      if(!checkfieldfordecimalnumbers("document.editcp.<%=TEXTFIELD_QCETSIVALUELIMITEXP%>","<%= ejbcawebbean.getText("ONLYDECINETSIVALUELIMIT") %>")){
         illegalfields++;
      }    
      if(document.editcp.<%=TEXTFIELD_QCETSIVALUELIMITEXP%>.value==""){
         alert("<%= ejbcawebbean.getText("ETSIVALUELIMCANNOTBEEMPTY", true) %>");
         illegalfields++;
      }
    }
    
    if(!document.editcp.<%=TEXTFIELD_QCETSIVALUELIMITCUR%>.disabled){   
      if(document.editcp.<%=TEXTFIELD_QCETSIVALUELIMITCUR%>.value==""){
      
         alert("<%= ejbcawebbean.getText("ETSIVALUELIMCANNOTBEEMPTY", true) %>");
         illegalfields++;
      }
    }    
   
     return illegalfields == 0;  
   } 
-->

</script>

<div align="center"> 
  <h2><c:out value="<%= ejbcawebbean.getText(\"EDITCERTIFICATEPROFILE\") %>" /></h2>
  <h3><c:out value="<%= ejbcawebbean.getText(\"CERTIFICATEPROFILE\")+ \" : \" + cp %>" /></h3>
</div>

<form name="editcp" method="post" action="<%=THIS_FILENAME %>">
  <input type="hidden" name='<%= ACTION %>' value='<%=ACTION_EDIT_CERTIFICATEPROFILE %>'>
  <input type="hidden" name='<%= HIDDEN_CERTIFICATEPROFILENAME %>' value='<c:out value="<%=cp %>"/>'>
  <table class="edit" width="100%" border="0" cellspacing="3" cellpadding="3">
    <tr id="Row<%=row++%2%>"> 
      <td width="50%" valign="top"> 
        <div align="left"> 
          &nbsp;
        </div>
      </td>
      <td width="50%" valign="top" align="right"> 
        <a href="<%=THIS_FILENAME %>"><c:out value="<%= ejbcawebbean.getText(\"BACKTOCERTIFICATEPROFILES\") %>" /></a>
      </td>
    </tr>


    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"CERTIFICATEPROFILEID\") %>" />
      </td>
      <td width="50%"> 
        <%= cabean.getCertificateProfileId(cp)  %>
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"TYPE\") %>" />
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_TYPE%>" size="1" onchange='typechanged()' >
           <%  int type = cpd.getType();
                for(int i=0; i<TYPE_IDS.length;i++){ %>
           <option  value="<%= TYPE_IDS[i] %>" 
              <%  if(TYPE_IDS[i] == type)
                    out.write(" selected ");
                  %>>
              <c:out value="<%= ejbcawebbean.getText(TYPE_NAMES[i]) %>" />         
           </option>  
              <% } %>
        </select>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"AVAILABLEBITLENGTHS\") %>" />
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_AVAILABLEBITLENGTHS%>" size="5" style="text-align:right;" multiple >
           <%  int[] availablebits = cpd.getAvailableBitLengths();
                for(int i=0; i<defaultavailablebitlengths.length;i++){ %>
           <option  value="<%= defaultavailablebitlengths[i] %>" 
              <% for(int j=0; j<availablebits.length;j++){
                   if(availablebits[j] == defaultavailablebitlengths[i])
                      out.write(" selected ");
                  }%>>
              <c:out value="<%= defaultavailablebitlengths[i] + \" \" + ejbcawebbean.getText(\"BITS\") %>" />         
           </option>  
              <% } %>
        </select>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"SIGNATUREALGORITHM\") %>" />
      </td>
      <td width="50%">
        <% String signAlg = cpd.getSignatureAlgorithm(); %>
        <select name="<%=SELECT_SIGNATUREALGORITHM%>" size="1">
             <option style="font-style:italic" value="<%= INHERITFROMCA %>" <% if(signAlg == null) { %>selected="selected"<% } %>><c:out value="<%= ejbcawebbean.getText(\"INHERITFROMCA\") %>" /></option>
           <% for(int i = 0; i < AlgorithmConstants.AVAILABLE_SIGALGS.length; i++) { %>
             <option value="<%= AlgorithmConstants.AVAILABLE_SIGALGS[i] %>" <% if((signAlg != null) && signAlg.equals(AlgorithmConstants.AVAILABLE_SIGALGS[i])) { %>selected="selected"<% } %>><%= AlgorithmConstants.AVAILABLE_SIGALGS[i] %></option>
           <% } %>
        </select>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"CERT_VALIDITY\") %>" /> <c:out value="<%= ejbcawebbean.getText(\"FORMAT_TIME_YMD\") %>" /> <c:out value="<%= ejbcawebbean.getText(\"ORENDDATE\") %>" />
        <%= ejbcawebbean.getHelpReference("/userguide.html#Validity") %>
      </td>
      <td width="50%"> 
        <input type="text" name="<%=TEXTFIELD_VALIDITY%>" size="25" maxlength="255" 
           value="<%= ValidityDate.getString(cpd.getValidity())  %>"
           title="<%= ejbcawebbean.getText("FORMAT_TIME_YMD") %> <%= ejbcawebbean.getText("OR") %> <%= ejbcawebbean.getText("FORMAT_ISO8601") %>" />
           <p class="help"><c:out value="<%= ejbcawebbean.getText(\"DATE_HELP\") %>" /> <c:out value="<%= ejbcawebbean.getDateExample()  %>" /></p>
      </td>
    </tr>


    
    <%-- Authorizations --%>

    <tr  id="Row<%=row%2%>" class="section"> 
      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"PERMISSIONS\") %>" /></strong>
      </td>
      <td width="50%"> 
        &nbsp;
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"ALLOWVALIDITYOVERRIDE\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#Validity") %>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_ALLOWVALIDITYOVERRIDE %>"  value="<%=CB_VALUE %>" 
           <% if(cpd.getAllowValidityOverride())
                 out.write("CHECKED");
           %> id="<%=CB_ALLOWVALIDITYOVERRIDE%>">
           <label for="<%=CB_ALLOWVALIDITYOVERRIDE%>"><c:out value="<%= ejbcawebbean.getText(\"ALLOW\") %>" /></label>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"ALLOWEXTENSIONOVERRIDE\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#Allow%20extension%20override") %>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_ALLOWEXTENSIONOVERRIDE %>"  value="<%=CB_VALUE %>" 
           <% if(cpd.getAllowExtensionOverride())
                 out.write("CHECKED");
           %> id="<%=CB_ALLOWEXTENSIONOVERRIDE%>">
           <label for="<%=CB_ALLOWEXTENSIONOVERRIDE%>"><c:out value="<%= ejbcawebbean.getText(\"ALLOW\") %>" /></label>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"ALLOWCERTSERIALNUMBEROVERRIDE\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#Allow%20certificate%20serial%20number%20override") %>
      </td>
      <td width="50%">
        <% if ( cabean.isUniqueIndexForSerialNumber() ) { %>
           <input type="checkbox" name="<%=CB_ALLOWCERTSERIALNUMBEROVERRIDE %>"  value="<%=CB_VALUE %>" 
           <% if(cpd.getAllowCertSerialNumberOverride()) {
                 out.write("CHECKED");
           }
           %> id="<%=CB_ALLOWCERTSERIALNUMBEROVERRIDE%>">
           <label for="<%=CB_ALLOWCERTSERIALNUMBEROVERRIDE%>"><c:out value="<%= ejbcawebbean.getText(\"ALLOW\") %>" /></label>
        <%} else {%>
           <c:out value="<%= ejbcawebbean.getText(\"CERTSERIALNOUNIQUEIX\") %>" />
        <%}%>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"ALLOWDNOVERRIDE\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#Allow%20subject%20DN%20override") %>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_ALLOWDNOVERRIDE %>"  value="<%=CB_VALUE %>" 
           <% if(cpd.getAllowDNOverride())
                 out.write("CHECKED");
           %> id="<%=CB_ALLOWDNOVERRIDE%>">
           <label for="<%=CB_ALLOWDNOVERRIDE%>"><c:out value="<%= ejbcawebbean.getText(\"ALLOW\") %>" /></label>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"ALLOWKEYUSAGEOVERRIDE\") %>" />
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_ALLOWKEYUSAGEOVERRIDE %>"  value="<%=CB_VALUE %>" 
           <% if(cpd.getAllowKeyUsageOverride())
                 out.write("CHECKED");
           %> id="<%=CB_ALLOWKEYUSAGEOVERRIDE%>">
           <label for="<%=CB_ALLOWKEYUSAGEOVERRIDE%>"><c:out value="<%= ejbcawebbean.getText(\"ALLOW\") %>" /></label>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"ALLOWBACKDATEDREVOCATION\") %>" />
        <%= ejbcawebbean.getHelpReference("/userguide.html#Allow%20back%20dated%20revocation") %>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_ALLOWBACKDATEDREVOCATION %>"  value="<%=CB_VALUE %>" 
           <% if(cpd.getAllowBackdatedRevocation())
                 out.write("CHECKED");
           %> id="<%=CB_ALLOWBACKDATEDREVOCATION%>">
           <label for="<%=CB_ALLOWBACKDATEDREVOCATION%>"><c:out value="<%= ejbcawebbean.getText(\"ALLOW\") %>" /></label>
      </td>
    </tr>


    <%-- X.509v3 extensions --%>

    <tr  id="Row<%=row%2%>" class="section"> 
      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"X509EXTENSIONS\") %>" /></strong>
      </td>
      <td width="50%"> 
        &nbsp;
      </td>
    </tr>

    <%-- Basic Constraints extension --%>
    <tr  id="Row<%=row%2%>"> 
      <td width="50%"  align="right">
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_BASICCONSTRAINTS\") %>" />
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_BASICCONSTRAINTS%>"   onClick="checkusebasicconstraintfield()" value="<%=CB_VALUE %>"
           <% if(cpd.getUseBasicConstraints()) 
                 out.write("CHECKED");
           %> id="<%=CB_BASICCONSTRAINTS%>">
           <label for="<%=CB_BASICCONSTRAINTS%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
           &nbsp;
           <input type="checkbox" name="<%=CB_BASICCONSTRAINTSCRITICAL%>" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseBasicConstraints())
                 out.write(" disabled ");  
               else
               if(cpd.getBasicConstraintsCritical())
                 out.write("CHECKED");
           %> id="<%=CB_BASICCONSTRAINTSCRITICAL%>">
           <label for="<%=CB_BASICCONSTRAINTSCRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label> 
      </td>
    </tr>  
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_BC_PATHLENGTH\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#Path%20Length%20Constraints") %>
      </td>
      <td width="50%">
           <% boolean enablepathlenconstraint =
           			cpd.getUseBasicConstraints() &&
           			(cpd.getType() == CertificateConstants.CERTTYPE_SUBCA ||
           			 cpd.getType() == CertificateConstants.CERTTYPE_ROOTCA); %>
           <input type="checkbox" name="<%=CB_USEPATHLENGTHCONSTRAINT %>"   onClick="checkusepathlengtconstraintfield()" value="<%=CB_VALUE %>" <% if(!enablepathlenconstraint) out.write(" disabled "); %>
           <% if(cpd.getUsePathLengthConstraint() && enablepathlenconstraint) 
                 out.write(" CHECKED ");
           %> id="<%=CB_USEPATHLENGTHCONSTRAINT%>">
           <label for="<%=CB_USEPATHLENGTHCONSTRAINT%>"><c:out value="<%= ejbcawebbean.getText(\"ADD\") %>" /></label>
           :&nbsp;
           <c:out value="<%= ejbcawebbean.getText(\"VALUE\") %>" />
           <input type="text" name="<%=TEXTFIELD_PATHLENGTHCONSTRAINT%>" size="2" maxlength="2"
                  title="<%= ejbcawebbean.getText("FORMAT_INTEGER") %>" 
           <%      if(!cpd.getUsePathLengthConstraint() || !enablepathlenconstraint) 
                       out.write(" disabled ");
                    else                       
                       out.write(" value=\"" + cpd.getPathLengthConstraint() + "\""); 
                      %>>
      </td>
    </tr>  

    <%-- Authority Key Identifier (AKI) extension --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
         <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_AUTHORITYKEYID\") %>" />
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_AUTHORITYKEYIDENTIFIER %>" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseAuthorityKeyIdentifier())
                 out.write("CHECKED");
           %> id="<%=CB_AUTHORITYKEYIDENTIFIER%>">
           <label for="<%=CB_AUTHORITYKEYIDENTIFIER%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>

    <%-- Subject Key Identifier (SKI) extension --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right">
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_SUBJECTKEYID\") %>" /> 
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_SUBJECTKEYIDENTIFIER %>" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseSubjectKeyIdentifier())
                 out.write("CHECKED");
           %> id="<%=CB_SUBJECTKEYIDENTIFIER%>">
           <label for="<%=CB_SUBJECTKEYIDENTIFIER%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>

    <%-- Key Usage (KU) extension --%>
    <tr  id="Row<%=row%2%>">
      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_KEYUSAGE\") %>" /></strong>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_KEYUSAGE %>" onClick="checkusekeyusagefield()" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseKeyUsage())
                 out.write("CHECKED");
           %> id="<%=CB_KEYUSAGE%>">
           <label for="<%=CB_KEYUSAGE%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
           &nbsp;
           <input type="checkbox" name="<%=CB_KEYUSAGECRITICAL %>" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseKeyUsage())
                 out.write(" disabled ");  
               else
               if(cpd.getKeyUsageCritical())
                 out.write("CHECKED");
           %> id="<%=CB_KEYUSAGECRITICAL%>">
           <label for="<%=CB_KEYUSAGECRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label>
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        &nbsp;
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_KEYUSAGE%>" size="9" multiple >
           <%  boolean[] ku = cpd.getKeyUsage();
                for(int i=0; i<keyusagetexts.length;i++){ %>
           <option  value="<%= i %>" 
              <% if(ku[i]) out.write(" selected "); %>> 
              <c:out value="<%= ejbcawebbean.getText(keyusagetexts[i]) %>" />
           </option>
           <%   } %> 
        </select>
      </td>
    </tr>

    <%-- Extended Key Usage (EKU) extension --%>
    <tr  id="Row<%=row%2%>"> 
      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_EXTENDEDKEYUSAGE\") %>" /></strong> <%= ejbcawebbean.getHelpReference("/userguide.html#Extended%20Key%20Usage") %>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USEEXTENDEDKEYUSAGE %>"  onclick="checkuseextendedkeyusagefield()" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseExtendedKeyUsage())
                 out.write("CHECKED");
           %> id="<%=CB_USEEXTENDEDKEYUSAGE%>">
           <label for="<%=CB_USEEXTENDEDKEYUSAGE%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
           &nbsp;
           <input type="checkbox" name="<%=CB_EXTENDEDKEYUSAGECRITICAL %>"  <% if(!cpd.getUseExtendedKeyUsage()) out.write(" disabled "); %> value="<%=CB_VALUE %>" 
           <% if(cpd.getExtendedKeyUsageCritical())
                 out.write("CHECKED");
           %> id="<%=CB_EXTENDEDKEYUSAGECRITICAL%>">
           <label for="<%=CB_EXTENDEDKEYUSAGECRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label>
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        &nbsp;
      </td>
      <td width="50%"> 
        <% List allekuoids = CertificateProfile.getAllExtendedKeyUsageOIDStrings();
           Map allekutexts = CertificateProfile.getAllExtendedKeyUsageTexts();
        %>
        <select name="<%=SELECT_EXTENDEDKEYUSAGE%>" size="10" multiple <% if(!cpd.getUseExtendedKeyUsage()) out.write(" disabled "); %>>
           <%   ArrayList eku = cpd.getExtendedKeyUsageOids();
                Iterator oiditer = allekuoids.iterator();
                while (oiditer.hasNext()) {
                	String oid = (String)oiditer.next();
                	String text = (String)allekutexts.get(oid);
                	if (text != null) { %>
                        <option  value="<%= oid %>" 
                        <% if (eku.contains(oid)) {
                	           out.write(" selected ");
                           } %>>
                        <c:out value="<%= ejbcawebbean.getText(text) %>" />
                        </option>	
                  <%}
                } %>
        </select>
      </td>
    </tr>

    <%-- Subject Alternative Name (SAN) extension --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_SUBJECTALTNAME\") %>" />
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_SUBJECTALTERNATIVENAME %>" onClick="checkusefield('<%=CB_SUBJECTALTERNATIVENAME %>', '<%=CB_SUBJECTALTERNATIVENAMECRITICAL %>')" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseSubjectAlternativeName())
                 out.write("CHECKED");
           %> id="<%=CB_SUBJECTALTERNATIVENAME%>">
           <label for="<%=CB_SUBJECTALTERNATIVENAME%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
           &nbsp;
           <input type="checkbox" name="<%=CB_SUBJECTALTERNATIVENAMECRITICAL %>" value="<%=CB_VALUE %>" 
           <% 
             if(!cpd.getUseSubjectAlternativeName())
                 out.write(" disabled "); 
              else
              if(cpd.getSubjectAlternativeNameCritical())
                 out.write("CHECKED");
           %> id="<%=CB_SUBJECTALTERNATIVENAMECRITICAL%>"> 
           <label for="<%=CB_SUBJECTALTERNATIVENAMECRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label>
      </td>
    </tr>

    <%-- Issuer Alternative Name (IAN) extension --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_ISSUERALTNAME\") %>" />
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_ISSUERALTERNATIVENAME %>" onClick="checkusefield('<%=CB_ISSUERALTERNATIVENAME %>', '<%=CB_ISSUERALTERNATIVENAMECRITICAL %>')" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseIssuerAlternativeName())
                 out.write("CHECKED");
           %> id="<%=CB_ISSUERALTERNATIVENAME%>">
           <label for="<%=CB_ISSUERALTERNATIVENAME%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
           &nbsp;
           <input type="checkbox" name="<%=CB_ISSUERALTERNATIVENAMECRITICAL %>" value="<%=CB_VALUE %>" 
           <% 
             if(!cpd.getUseIssuerAlternativeName())
                 out.write(" disabled "); 
              else
              if(cpd.getIssuerAlternativeNameCritical())
                 out.write("CHECKED");
           %> id="<%=CB_ISSUERALTERNATIVENAMECRITICAL%>"> 
           <label for="<%=CB_ISSUERALTERNATIVENAMECRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label>
      </td>
    </tr>

    <%-- Document Type List (DTL) extension --%>
    <tr  id="Row<%=row%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_DOCUMENTTYPELIST\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#Document%20Type%20List") %>
      </td>
      <td width="50%">
      		<input type="checkbox" name="<%=CB_USEDOCUMENTTYPE %>" onClick="checkusedocumenttypefield()" value="<%=CB_VALUE %>" 
           	<% if(cpd.getUseDocumentTypeList())
                 out.write("CHECKED");
           	%> id="<%=CB_USEDOCUMENTTYPE%>">
    	    <label for="<%=CB_USEDOCUMENTTYPE%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
           	&nbsp;
           	<input type="checkbox" name="<%=CB_DOCUMENTTYPECRITICAL %>" value="<%=CB_VALUE %>" 
           	<% 
             if(!cpd.getUseDocumentTypeList())
                 out.write(" disabled "); 
              else
              if(cpd.getDocumentTypeListCritical())
                 out.write("CHECKED");
           	%> id="<%=CB_DOCUMENTTYPECRITICAL%>"> 
           	<label for="<%=CB_DOCUMENTTYPECRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label>
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        &nbsp;
      </td>
      <td width="50%"> 
        <input type="text" name="<%=TEXTFIELD_DOCUMENTTYPE%>" size="45" maxlength="4096"  
           <%       if(!cpd.getUseDocumentTypeList())
                      out.write(" disabled "); 
                    else 
                      if(cpd.getDocumentTypeList().size() > 0) {%>
                       value="<c:out value="<%= cabean.getDocumentTypeListStr(cpd) %>"/>"
                      <%} else {%>
                       value="<c:out value=""/>"
                      <%}%> >
      </td>
    </tr>
    
    

    <%-- Subject Directory Attributes (SDA) extension --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_SUBJECTDIRATTRS\") %>" />
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_SUBJECTDIRATTRIBUTES %>" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseSubjectDirAttributes())
                 out.write("CHECKED");
           %> id="<%=CB_SUBJECTDIRATTRIBUTES%>">
           <label for="<%=CB_SUBJECTDIRATTRIBUTES%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>
    
    <%-- Name Constraints extension --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_NAMECONSTRAINTS\") %>" />
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_NAMECONSTRAINTS%>" value="<%=CB_VALUE %>" onClick="checkusefield('<%=CB_NAMECONSTRAINTS%>', '<%=CB_NAMECONSTRAINTSCRITICAL %>')"
           <% if(cpd.getUseNameConstraints())
                 out.write("CHECKED");
           %> id="<%=CB_NAMECONSTRAINTS%>">
           <label for="<%=CB_NAMECONSTRAINTS%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
           &nbsp;
           <input type="checkbox" name="<%=CB_NAMECONSTRAINTSCRITICAL %>" value="<%=CB_VALUE %>" 
           <% 
             if(!cpd.getUseNameConstraints())
                 out.write(" disabled "); 
              else
              if(cpd.getNameConstraintsCritical())
                 out.write("CHECKED");
           %> id="<%=CB_NAMECONSTRAINTSCRITICAL%>"> 
           <label for="<%=CB_NAMECONSTRAINTSCRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label>
      </td>
    </tr>

    <%-- CRL Distribution Points (CRL-DP) extension --%>
    <tr  id="Row<%=row%2%>"> 
      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CRLDISTRIBPOINTS\") %>" /></strong>
        <%= ejbcawebbean.getHelpReference("/userguide.html#CRL%20Distribution%20Points") %>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_CRLDISTRIBUTIONPOINT %>" onClick="checkusecrldisturifield()" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseCRLDistributionPoint())
                 out.write("CHECKED");
           %> id="<%=CB_CRLDISTRIBUTIONPOINT%>">
           <label for="<%=CB_CRLDISTRIBUTIONPOINT%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
           &nbsp;
          <input type="checkbox" name="<%=CB_CRLDISTRIBUTIONPOINTCRITICAL %>" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseCRLDistributionPoint())
                 out.write(" disabled "); 
               else
                 if(cpd.getCRLDistributionPointCritical())
                 out.write("CHECKED");
           %> id="<%=CB_CRLDISTRIBUTIONPOINTCRITICAL%>">
           <label for="<%=CB_CRLDISTRIBUTIONPOINTCRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label>
         </td>
       </tr>
       <tr  id="Row<%=row%2%>">
         <td width="50%"  align="right">
           <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CDP_CADEFINED\") %>" />
           
         </td>
         <td width="50%">
           <input type="checkbox" name="<%=CB_USEDEFAULTCRLDISTRIBUTIONPOINT %>" onClick="checkusedefaultsecrldisturifield()" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseCRLDistributionPoint())
                 out.write(" disabled "); 
               else
                 if(cpd.getUseDefaultCRLDistributionPoint())
                 out.write(" CHECKED ");
           %> id="<%=CB_USEDEFAULTCRLDISTRIBUTIONPOINT%>">
           <label for="<%=CB_USEDEFAULTCRLDISTRIBUTIONPOINT%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
         </td>
       </tr>
       <tr  id="Row<%=row%2%>">
         <td width="50%"  align="right">
           <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CDP_URI\") %>" />
         </td>
         <td width="50%">
           <input type="text" name="<%=TEXTFIELD_CRLDISTURI%>" size="45" maxlength="4096" title="<%= ejbcawebbean.getText("FORMAT_URI") %>" 
           <%       if(!cpd.getUseCRLDistributionPoint() || cpd.getUseDefaultCRLDistributionPoint())
                      out.write(" disabled "); 
                    else 
                      if(!cpd.getCRLDistributionPointURI().equals("")) {%>
                       value="<c:out value="<%= cpd.getCRLDistributionPointURI() %>"/>"
                      <%} else {%>
                       value="<c:out value="<%= globalconfiguration.getStandardCRLDistributionPointURI() %>"/>"
                      <%}%> >
           </td>
         </tr>
         <tr  id="Row<%=row++%2%>"> 
           <td width="50%"  align="right">
             <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CDP_CRLISSUER\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#CRL%20Issuer") %>
           </td>
           <td width="50%">
           <input type="text" name="<%=TEXTFIELD_CRLISSUER%>" size="45" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_DN") %>"
           <%       if(!cpd.getUseCRLDistributionPoint() || cpd.getUseDefaultCRLDistributionPoint()) {
                      out.write(" disabled "); 
                    } else {
                      if(!cpd.getCRLIssuer().equals("")) {%>
                       value="<c:out value="<%= cpd.getCRLIssuer() %>"/>"
                      <%} else if(cpd.getCRLDistributionPointURI().equals("")) {
                    	  // Only add default CRLIssuer if this was the first time we enabled this checkbox, so both fields are empty
                    	  %>
                         value="<c:out value="<%= globalconfiguration.getStandardCRLIssuer() %>"/>"
                      <%}
                    }
            %>>
      </td>
    </tr>

    <%-- Freshest CRL extension --%>
    <tr  id="Row<%=row%2%>">
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_FRESHESTCRL\") %>" />
        <%= ejbcawebbean.getHelpReference("/userguide.html#Freshest%20CRL") %>
       </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USEFRESHESTCRL %>" onClick="checkusefreshestcrlfield()" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseFreshestCRL())
                 out.write("CHECKED");
           %> id="<%=CB_USEFRESHESTCRL%>">
           <label for="<%=CB_USEFRESHESTCRL%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
         </td>
       </tr>
       
       <tr  id="Row<%=row%2%>"> 
         <td width="50%"  align="right"> 
           <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_FCRL_CADEFINED\") %>" />
         </td>
         <td width="50%">
          <input type="checkbox" name="<%=CB_USECADEFINEDFRESHESTCRL %>" onClick="checkusecadefinedfreshestcrlfield()" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseFreshestCRL())
                 out.write(" disabled "); 
               else
                 if(cpd.getUseCADefinedFreshestCRL())
                 out.write(" CHECKED ");
           %> id="<%=CB_USECADEFINEDFRESHESTCRL%>">
           <label for="<%=CB_USECADEFINEDFRESHESTCRL%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
         </td>
       </tr>
       
       <tr  id="Row<%=row++%2%>">
         <td width="50%"  align="right">
           <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_FCRL_URI\") %>" />
         </td>
         <td width="50%">
           <input type="text" name="<%=TEXTFIELD_FRESHESTCRLURI%>" size="45" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_URI") %>"
           <%       if(!cpd.getUseFreshestCRL() || cpd.getUseCADefinedFreshestCRL())
                      out.write(" disabled "); 
                    else 
                      if(!cpd.getFreshestCRLURI().equals("")) {%>
                         value="<c:out value="<%= cpd.getFreshestCRLURI() %>"/>"
                      <%} else {%>
                         value="<c:out value="<%= globalconfiguration.getStandardDeltaCRLDistributionPointURI() %>"/>"
                      <%}%> >
      </td>
    </tr>
    
    <%-- Certificate Policies extension --%>
    <% List policies = cpd.getCertificatePolicies(); %>
    <tr  id="Row<%=row%2%>"> 
      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CERTIFICATEPOLICIES\") %>" /></strong>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USECERTIFICATEPOLICIES %>" onClick="checkusecertificatepoliciesfield(<%= policies.size() %>)" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseCertificatePolicies())
                 out.write("CHECKED");
            %> id="<%=CB_USECERTIFICATEPOLICIES%>">
            <label for="<%=CB_USECERTIFICATEPOLICIES%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
            &nbsp;
          <input type="checkbox" name="<%=CB_CERTIFICATEPOLICIESCRITICAL %>" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseCertificatePolicies())
                 out.write(" disabled "); 
               else
                 if(cpd.getCertificatePoliciesCritical())
                 out.write("CHECKED");
            %> id="<%=CB_CERTIFICATEPOLICIESCRITICAL%>">
            <label for="<%=CB_CERTIFICATEPOLICIESCRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label>
      </td>
    </tr>
    <%-- List of already defined policies. --%>
    <% if((policies != null) && (policies.size() > 0)) {
           CertificatePolicy policy;
           int i = 0;
           for(Iterator it = cpd.getCertificatePolicies().iterator(); it.hasNext(); i++) {
               policy = (CertificatePolicy) it.next();
           %>
    <tr id="Row<%=row%2%>">
      <td width="50%" align="right">
        <input type="submit" name="<%= BUTTON_DELETE_POLICY + i %>" value="<%= ejbcawebbean.getText("DELETE") %>"/>
        &nbsp;&nbsp;&nbsp;
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CP_POLICYID\") %>" />
      </td>
      <td width="50%">
        <input readonly type="text" name="<%= TEXTFIELD_CERTIFICATEPOLICYID + i %>" value="<c:out value="<%= policy.getPolicyID() %>"/>" size="20" maxlength="255"/>
      </td>
 	    </tr>
 	    <tr id="Row<%=row%2%>">
 	      <td width="50%" align="right">
 	            <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CP_USERNOTICE\") %>" />
 	      </td>
 	      <td width="50%">
 	        <input readonly type="text" name="<%= TEXTAREA_POLICYNOTICE_UNOTICE + i %>" value="<% if((policy.getQualifierId() != null) && (policy.getQualifierId().equals(CertificatePolicy.id_qt_unotice)) && (policy.getQualifier() != null)) { %><c:out value="<%= policy.getQualifier() %>"/><% } %>" size="45" maxlength="255"/>
 	      </td>
 	    </tr>
 	    <tr id="Row<%=row%2%>">
 	      <td width="50%" align="right">
 	            <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CP_CPSURI\") %>" />
 	      </td>
 	      <td width="50%">
 	        <input readonly type="text" name="<%= TEXTFIELD_POLICYNOTICE_CPSURL + i %>" value="<% if((policy.getQualifierId() != null) && (policy.getQualifierId().equals(CertificatePolicy.id_qt_cps)) && (policy.getQualifier() != null)) { %><c:out value="<%= policy.getQualifier() %>"/><% } %>" size="45" maxlength="255"/>
      </td>
    </tr>
        <% }
       }
    %>
    <%-- Editable policy input form section --%>
    <tr id="Row<%=row%2%>">
 	      <td width="50%" align="right">
 	            <input type="submit" name="<%= BUTTON_ADD_POLICY %>" value="<%= ejbcawebbean.getText("ADD") %>" <%=cpd.getUseCertificatePolicies() ? "" : "disabled"%>/>
 	            &nbsp;&nbsp;&nbsp;
 	            <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CP_POLICYID\") %>" />
 	      </td>
 	      <td width="50%">
 	        <input type="text" name="<%=TEXTFIELD_CERTIFICATEPOLICYID%>" size="20" maxlength="255" <%=cpd.getUseCertificatePolicies() ? "" : "disabled"%> title="<%= ejbcawebbean.getText("FORMAT_OID") %>"/>
 	      </td>
 	    </tr>
 	    <tr id="Row<%=row%2%>">
 	      <td width="50%" align="right">
 	            <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CP_USERNOTICE\") %>" />
 	      </td>
 	      <td width="50%">
 	        <input type="text" name="<%=TEXTAREA_POLICYNOTICE_UNOTICE%>" size="45" maxlength="255" <%=cpd.getUseCertificatePolicies() ? "" : "disabled"%> title="<%= ejbcawebbean.getText("FORMAT_STRING") %>"/>
 	      </td>
 	    </tr>    
    <tr id="Row<%=row++%2%>">
      <td width="50%" align="right">
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_CP_CPSURI\") %>" />
      </td>
      <td width="50%">
        <input type="text" name="<%=TEXTFIELD_POLICYNOTICE_CPSURL%>" size="45" maxlength="255" <%=cpd.getUseCertificatePolicies() ? "" : "disabled"%> title="<%= ejbcawebbean.getText("FORMAT_URI") %>"/>
      </td>
    </tr>
    
    <%-- Authority Information Access (AIA) extension --%>
	<% List caissuers = cpd.getCaIssuers(); %>
    <tr  id="Row<%=row%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_AUTHORITYINFOACCESS\") %>" /> 
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USEAUTHORITYINFORMATIONACCESS %>" onClick="checkuseaiafield(<%= caissuers.size() %>)" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseAuthorityInformationAccess())
                 out.write("CHECKED");
           %> id="<%=CB_USEAUTHORITYINFORMATIONACCESS%>">
           <label for="<%=CB_USEAUTHORITYINFORMATIONACCESS%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>
    <%-- ocsp service locator part of authority information access (aia) extension --%>
    <tr  id="Row<%=row%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_AIA_OCSP_CADEFINED\") %>" />
      </td>
      <%-- ocsp service locator part of authority information access (aia) extension --%>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USEDEFAULTOCSPSERVICELOCALTOR %>" onClick="checkdefaultocspservicelocatorfield()" value="<%=CB_VALUE %>" 
           <% if(!cpd.getUseAuthorityInformationAccess())
                 out.write(" disabled ");
              if(cpd.getUseDefaultOCSPServiceLocator())
                 out.write(" CHECKED ");
           %> id="<%=CB_USEDEFAULTOCSPSERVICELOCALTOR%>">
           <label for="<%=CB_USEDEFAULTOCSPSERVICELOCALTOR%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
         </td>
       </tr>
       <tr  id="Row<%=row%2%>"> 
 	      <td width="50%"  align="right">
 	        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_AIA_OCSP_URI\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#OCSP%20Service%20Locator") %>
 	      </td>
 	      <td width="50%">
           <input type="text" name="<%=TEXTFIELD_OCSPSERVICELOCATOR%>" size="45" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_URI") %>"
           <%       if(!cpd.getUseAuthorityInformationAccess() || cpd.getUseDefaultOCSPServiceLocator())
                      out.write(" disabled "); 
                    else {
                       String ocspuri = cpd.getOCSPServiceLocatorURI();
                       if (ocspuri == null) {ocspuri = "";} %>
                       value="<c:out value="<%= ocspuri %>"/>"
                    <%}
           %>>
      </td>
    </tr>
    <%-- caIssuers part of authority information access (aia) extension --%>
    <%-- List of already defined caIssuers URIs. --%>
    <% if((caissuers != null) && (caissuers.size() > 0)) {
           String uri;
           int i = 0;
           for(Iterator it = caissuers.iterator(); it.hasNext(); i++) {
               uri = (String) it.next();
           %>
    <tr id="Row<%=row%2%>">
      <td width="50%" align="right">
        <input type="submit" name="<%= BUTTON_DELETE_CAISSUERURI + i %>" value="<%= ejbcawebbean.getText("DELETE") %>"/>
        &nbsp;&nbsp;&nbsp;
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_AIA_CAISSUERS_URI\") %>" />
      </td>
      <td width="50%">
        <input readonly type="text" name="<%= TEXTFIELD_CAISSUERURI + i %>" value="<c:out value="<%= uri %>"/>" size="45" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_URI") %>"/>
      </td>
    </tr>
        <% }
       }
    %>
    <%-- Editable caIssuers URI input form section --%>
    <tr id="Row<%=row++%2%>">
      <td width="50%" align="right">
        <input type="submit" name="<%= BUTTON_ADD_CAISSUERURI %>" value="<%= ejbcawebbean.getText("ADD") %>" <%=cpd.getUseAuthorityInformationAccess() ? "" : "disabled"%>/>
        &nbsp;&nbsp;&nbsp;
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_AIA_CAISSUERS_URI\") %>" />
      </td>
      <td width="50%">
        <input type="text" name="<%=TEXTFIELD_CAISSUERURI%>" size="45" maxlength="255" <%=cpd.getUseAuthorityInformationAccess() ? "" : "disabled"%>/>
      </td>
    </tr>

 	<%-- Private Key Usage Period extension --%>
	<tr id="Row<%=row%2%>">
	  <td width="50%" align="right">
	  	<c:out value="<%=ejbcawebbean.getText(\"EXT_PKIX_PRIVKEYUSAGEPERIOD\")%>" /> <%=ejbcawebbean.getHelpReference("/userguide.html#Private%20Key%20Usage%20Period")%>
	  </td>
	  <td width="50%">
	    <input name="<%=CB_USEPRIVKEYUSAGEPERIODNOTBEFORE%>" onclick="checkprivkeyusageperiodnotbeforefield()" type="checkbox" value="<%=CB_VALUE%>" <%=cpd.isUsePrivateKeyUsagePeriodNotBefore() ? "CHECKED" : ""%>
	    id="<%=CB_USEPRIVKEYUSAGEPERIODNOTBEFORE%>">
	    <label for="<%=CB_USEPRIVKEYUSAGEPERIODNOTBEFORE%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_PKUP_STARTOFFSET\") %>" /></label>
	    <c:out value="<%= ejbcawebbean.getText(\"FORMAT_TIME_YMD\") %>" />
	    &nbsp;
	    <input type="text" name="<%=TEXTFIELD_PRIVKEYUSAGEPERIODSTARTOFFSET%>" size="20" maxlength="255" <%=cpd.isUsePrivateKeyUsagePeriodNotBefore() ? "" : "disabled"%> value="<%=cpd.isUsePrivateKeyUsagePeriodNotBefore() ? ValidityDate.getString(cpd.getPrivateKeyUsagePeriodStartOffset() / (24 * 3600)) : ""%>" title="<%= ejbcawebbean.getText("FORMAT_TIME_YMD") %>" />
	  </td>
	</tr>
	
	<tr id="Row<%=row++%2%>">
	  <td width="50%" align="right">
	  	&nbsp;
	  </td>
	  <td width="50%">
	    <input name="<%=CB_USEPRIVKEYUSAGEPERIODNOTAFTER%>" onclick="checkprivkeyusageperiodnotafterfield()" type="checkbox" value="<%=CB_VALUE%>" <%=cpd.isUsePrivateKeyUsagePeriodNotAfter() ? "CHECKED" : ""%>
	    id="<%=CB_USEPRIVKEYUSAGEPERIODNOTAFTER%>">
	    <label for="<%=CB_USEPRIVKEYUSAGEPERIODNOTAFTER%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_PKUP_PERIODLENGTH\") %>" /></label>
	    <c:out value="<%= ejbcawebbean.getText(\"FORMAT_TIME_YMD\") %>" />
	    &nbsp;
	    <input type="text" name="<%=TEXTFIELD_PRIVKEYUSAGEPERIODLENGTH%>" size="20" maxlength="255" <%=cpd.isUsePrivateKeyUsagePeriodNotAfter() ? "" : "disabled"%> value="<%=cpd.isUsePrivateKeyUsagePeriodNotAfter() ? ValidityDate.getString(cpd.getPrivateKeyUsagePeriodLength() / (24 * 3600)) : ""%>" title="<%= ejbcawebbean.getText("FORMAT_TIME_YMD") %>" />
	  </td>
	</tr>

    <%-- Qualified Certificates Statements (qcStatements) extension --%>
    <tr  id="Row<%=row++%2%>" class="section">
 	  <td width="50%"  align="right"> 
 	    <strong><c:out value="<%= ejbcawebbean.getText(\"EXT_HEADER_QCSTATEMENTS\") %>" /></strong>
      </td>
      <td width="50%"> 
        &nbsp;
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right" > 
        <strong><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_QCSTATEMENTS\") %>" /></strong>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USEQCSTATEMENT %>" onClick="checkuseqcstatementfield()" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseQCStatement())
                 out.write("CHECKED");
           %> id="<%=CB_USEQCSTATEMENT%>">
           <label for="<%=CB_USEQCSTATEMENT%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
           &nbsp;
           <input type="checkbox" name="<%=CB_QCSTATEMENTCRITICAL %>" value="<%=CB_VALUE %>"              
           <%
               if(!cpd.getUseQCStatement())
                 out.write(" disabled "); 
               else
                 if(cpd.getQCStatementCritical())
                   out.write("CHECKED");
           %> id="<%=CB_QCSTATEMENTCRITICAL%>">
           <label for="<%=CB_QCSTATEMENTCRITICAL%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CRITICAL\") %>" /></label>
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_QCS_PKIXQCSYNTAXV2\") %>" /></td>
      <td width="50%" valign="top">
         <input type="checkbox" name="<%=CB_USEPKIXQCSYNTAXV2 %>" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseQCStatement())
                 out.write(" disabled "); 
               else
                 if(cpd.getUsePkixQCSyntaxV2())
                   out.write("CHECKED");
           %> id="<%=CB_USEPKIXQCSYNTAXV2%>">
           <label for="<%=CB_USEPKIXQCSYNTAXV2%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_QCS_SEMANTICSID\") %>" /> </td>
      <td width="50%" valign="top"><input type="text" name="<%=TEXTFIELD_QCSSEMANTICSID %>" size="20" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_OID") %>"
           <%       if(!cpd.getUseQCStatement()) {
                      out.write(" disabled "); 
                    } else {%> 
                      value="<c:out value="<%= cpd.getQCSemanticsId() %>"/>"
                    <%}%> >
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_QCS_NAMERA\") %>" /> </td>
      <td width="50%" valign="top"><input type="text" name="<%=TEXTFIELD_QCSTATEMENTRANAME %>" size="45" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_STRING") %>"
           <%       if(!cpd.getUseQCStatement()) {
                      out.write(" disabled "); 
                    } else { %> 
                      value="<c:out value="<%= cpd.getQCStatementRAName() %>"/>"
                    <%}%> >
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_ETSI_QCS_QCCOMPLIANCE\") %>" /> </td>
      <td width="50%" valign="top"><input type="checkbox" name="<%=CB_USEQCETSIQCCOMPLIANCE %>" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseQCStatement())
                 out.write(" disabled "); 
               else
                 if(cpd.getUseQCEtsiQCCompliance())
                   out.write("CHECKED");
           %> id="<%=CB_USEQCETSIQCCOMPLIANCE%>">
           <label for="<%=CB_USEQCETSIQCCOMPLIANCE%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_ETSI_QCS_SSCD\") %>" /> </td>
      <td width="50%" valign="top"><input type="checkbox" name="<%=CB_USEQCETSISIGNATUREDEVICE %>" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseQCStatement())
                 out.write(" disabled "); 
               else
                 if(cpd.getUseQCEtsiSignatureDevice())
                   out.write("CHECKED");
           %> id="<%=CB_USEQCETSISIGNATUREDEVICE%>">
           <label for="<%=CB_USEQCETSISIGNATUREDEVICE%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_ETSI_QCS_VALUELIMIT\") %>" /> </td>
      <td width="50%" valign="top"><input type="checkbox" name="<%=CB_USEQCETSIVALUELIMIT %>" onClick="checkuseetsivaluelimitfield()" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseQCStatement())
                 out.write(" disabled "); 
               else
                 if(cpd.getUseQCEtsiValueLimit())
                   out.write("CHECKED");
           %> id="<%=CB_USEQCETSIVALUELIMIT%>">
           <label for="<%=CB_USEQCETSIVALUELIMIT%>"><c:out value="<%= ejbcawebbean.getText(\"ADD\") %>" /></label>
           :&nbsp;
           <c:out value="<%= ejbcawebbean.getText(\"EXT_ETSI_QCS_VL_CURRENCY\") %>" />
           <input type="text" name="<%=TEXTFIELD_QCETSIVALUELIMITCUR %>" size="3" maxlength="3"
               title="<%= ejbcawebbean.getText("FORMAT_ISO4217") %>" style="text-align: center;"
           <%       if(!cpd.getUseQCStatement() || !cpd.getUseQCEtsiValueLimit()) {
                      out.write(" disabled "); 
                    } else {%> 
                      value="<c:out value="<%= cpd.getQCEtsiValueLimitCurrency() %>"/>"
                    <%}%> >
           &nbsp;
           <c:out value="<%= ejbcawebbean.getText(\"EXT_ETSI_QCS_VL_AMOUNT\") %>" />
           <input type="text" name="<%=TEXTFIELD_QCETSIVALUELIMIT %>" size="3" maxlength="6"
               title="<%= ejbcawebbean.getText("FORMAT_INTEGER") %>"
           <%       if(!cpd.getUseQCStatement() || !cpd.getUseQCEtsiValueLimit()) {
                      out.write(" disabled "); 
                    } else {%> 
                      value="<c:out value="<%= cpd.getQCEtsiValueLimit() %>"/>"
                    <%}%> >
           &times;10^
           <c:out value="<%= ejbcawebbean.getText(\"EXT_ETSI_QCS_VL_EXPONENT\") %>" />
           <input type="text" name="<%=TEXTFIELD_QCETSIVALUELIMITEXP %>" size="2" maxlength="2"
               title="<%= ejbcawebbean.getText("FORMAT_INTEGER") %>"
           <%       if(!cpd.getUseQCStatement() || !cpd.getUseQCEtsiValueLimit()) {
                      out.write(" disabled "); 
                    } else {%> 
                      value="<c:out value="<%= cpd.getQCEtsiValueLimitExp() %>"/>"
                    <%}%> >
      </td>
    </tr>                     
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_ETSI_QCS_RETENTIONPERIOD\") %>" /> </td>
      <td width="50%" valign="top"><input type="checkbox" name="<%=CB_USEQCETSIRETENTIONPERIOD %>" onClick="checkusetsiretentionperiod()" value="<%=CB_VALUE %>"
           <%
               if(!cpd.getUseQCStatement())
                 out.write(" disabled "); 
               else
                 if(cpd.getUseQCEtsiRetentionPeriod())
                   out.write("CHECKED");
           %> id="<%=CB_USEQCETSIRETENTIONPERIOD%>">
           <label for="<%=CB_USEQCETSIRETENTIONPERIOD%>"><c:out value="<%= ejbcawebbean.getText(\"ADD\") %>" /></label>
           :&nbsp;
           <c:out value="<%= ejbcawebbean.getText(\"VALUE\") %>" />
           <c:out value="<%= ejbcawebbean.getText(\"UNIT_YEARS\") %>" />
           <input type="text" name="<%=TEXTFIELD_QCETSIRETENTIONPERIOD %>" size="2" maxlength="3"
               title="<%= ejbcawebbean.getText("FORMAT_INTEGER") %>"
           <%       if(!cpd.getUseQCStatement() || !cpd.getUseQCEtsiRetentionPeriod()) {
                      out.write(" disabled "); 
                    } else {%> 
                      value="<c:out value="<%= cpd.getQCEtsiRetentionPeriod() %>"/>"
                    <%}%> >
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_QCS_CUSTOMSTRING\") %>" /> </td>
      <td width="50%" valign="top"><input type="checkbox" name="<%=CB_USEQCCUSTOMSTRING %>" onClick="checkuseqccustomstring()" value="<%=CB_VALUE %>" 
           <%
               if(!cpd.getUseQCStatement())
                 out.write(" disabled "); 
               else
                 if(cpd.getUseQCCustomString())
                   out.write("CHECKED");
           %> id="<%=CB_USEQCCUSTOMSTRING%>">
           <label for="<%=CB_USEQCCUSTOMSTRING%>"><c:out value="<%= ejbcawebbean.getText(\"ADD\") %>" /></label>
           :&nbsp;
           <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_QCS_CUSTOMSTR_OID\") %>" />
           <input type="text" name="<%=TEXTFIELD_QCCUSTOMSTRINGOID %>" size="20" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_OID") %>"
           <%       if(!cpd.getUseQCStatement() || !cpd.getUseQCCustomString()) {
                      out.write(" disabled "); 
                    } else {%> 
                      value="<c:out value="<%= cpd.getQCCustomStringOid() %>"/>"
                    <%}%> >
      </td>
    </tr>     
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_QCS_CUSTOMSTR_TEXT\") %>" /> </td>
      <td width="50%" valign="top"><input type="text" name="<%=TEXTFIELD_QCCUSTOMSTRINGTEXT %>" size="45" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_STRING") %>"
           <%       if(!cpd.getUseQCStatement() || !cpd.getUseQCCustomString()) {
                      out.write(" disabled "); 
                    } else {%> 
                      value="<c:out value="<%= cpd.getQCCustomStringText() %>"/>"
                    <%}%> >
      </td>
    </tr>  

    <%-- Certificate Transparency --%>
    <%
    if (CertificateTransparencyFactory.isCTAvailable()) {
        Set<Integer> enabledCTLogs = cpd.getEnabledCTLogs();
        Map<Integer,CTLogInfo> availableCTLogs = globalconfiguration.getCTLogs();
    %>
    
    <tr  id="Row<%=row++%2%>" class="section">
      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"EXT_HEADER_CERTIFICATETRANSPARENCY\") %>" /></strong>
      </td>
      <td width="50%"> 
        &nbsp;
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right" > 
        <strong><c:out value="<%= ejbcawebbean.getText(\"EXT_CERTIFICATE_TRANSPARENCY\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#Certificate%20Transparency%20(Enterprise%20only)") %></strong>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USECERTIFICATETRANSPARENCYINCERTS %>" onClick="checkusecertificatetransparencyfield()" value="<%=CB_VALUE %>" 
           <% if (cpd.isUseCertificateTransparencyInCerts())
                 out.write("CHECKED");
           %> id="<%=CB_USECERTIFICATETRANSPARENCYINCERTS%>">
           <label for="<%=CB_USECERTIFICATETRANSPARENCYINCERTS%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CT_USE_IN_CERTS\") %>" /></label>
           
           <br />
           
           <input type="checkbox" name="<%=CB_USECERTIFICATETRANSPARENCYINOCSP %>" onClick="checkusecertificatetransparencyfield()" value="<%=CB_VALUE %>" 
           <% if (cpd.isUseCertificateTransparencyInOCSP())
                 out.write("CHECKED");
           %> id="<%=CB_USECERTIFICATETRANSPARENCYINOCSP%>">
           <label for="<%=CB_USECERTIFICATETRANSPARENCYINOCSP%>"><c:out value="<%= ejbcawebbean.getText(\"EXT_CT_USE_IN_OCSP\") %>" /></label>
           <%
           boolean ctEnabled = cpd.isUseCertificateTransparencyInCerts() || cpd.isUseCertificateTransparencyInOCSP();
           %>
      </td>
    </tr>
    <%-- Enabled CT logs selection --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_CT_ENABLEDLOGS\") %>" />
      </td>
      <td width="50%">
        <select name="<%=SELECT_CTLOGS%>" size="6" multiple="multiple"<%= ctEnabled ? "" : " disabled" %>>
           <% for (CTLogInfo ctlog : availableCTLogs.values()) { %>
              <option value="<c:out value="<%= ctlog.getLogId() %>" />" <% if (enabledCTLogs.contains(ctlog.getLogId())) { %>selected="selected"<% } %>><c:out value="<%= ctlog.getUrl() %>" /></option>
           <% } %>
        </select>
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_CT_MINSCTS\") %>" /> </td>
      <td width="50%" valign="top"><input type="text" name="<%=TEXTFIELD_CTMINSCTS %>" size="8" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_INTEGER") %>"
           <%       if (!ctEnabled) {
                      out.write(" disabled ");
                    } else {%> 
                      value="<c:out value="<%= cpd.getCTMinSCTs() %>"/>"
                    <%}%> >
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_CT_MAXSCTS\") %>" /> </td>
      <td width="50%" valign="top"><input type="text" name="<%=TEXTFIELD_CTMAXSCTS %>" size="8" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_INTEGER") %>"
           <%       if (!ctEnabled) {
                      out.write(" disabled ");
                    } else {%> 
                      value="<c:out value="<%= cpd.getCTMaxSCTs() %>"/>"
                    <%}%> >
      </td>
    </tr>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"><c:out value="<%= ejbcawebbean.getText(\"EXT_CT_MAXRETRIES\") %>" /> </td>
      <td width="50%" valign="top"><input type="text" name="<%=TEXTFIELD_CTMAXRETRIES %>" size="8" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_INTEGER") %>"
           <%       if (!ctEnabled) {
                      out.write(" disabled ");
                    } else {%> 
                      value="<c:out value="<%= cpd.getCTMaxRetries() %>"/>"
                    <%}%> >
      </td>
    </tr>
    <% } %>


    <%-- Other extensions --%>
    <tr  id="Row<%=row%2%>" class="section">
      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"OTHEREXTENSIONS\") %>" /></strong>
      </td>
      <td width="50%"> 
        &nbsp;
      </td>
    </tr>

    <%-- OCSP No Check extension --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_OCSPNOCHECK\") %>" />
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USEOCSPNOCHECK %>" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseOcspNoCheck())
                 out.write("CHECKED");
           %> id="<%=CB_USEOCSPNOCHECK%>">
           <label for="<%=CB_USEOCSPNOCHECK%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>
    
    <%-- MS Template extension --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_MS_TEMPLATENAME\") %>" /> 
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USEMSTEMPLATE %>"  onclick="checkusemstemplatefield()" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseMicrosoftTemplate())
                 out.write("CHECKED");
           %> id="<%=CB_USEMSTEMPLATE%>">
           <label for="<%=CB_USEMSTEMPLATE%>"><c:out value="<%= ejbcawebbean.getText(\"ADD\") %>" /></label>
           :&nbsp;
           <c:out value="<%= ejbcawebbean.getText(\"VALUE\") %>" />
           <select name="<%=SELECT_MSTEMPLATE%>"  <% if(!cpd.getUseMicrosoftTemplate()) out.write(" disabled "); %>>
           <%  
                for(int i=0; i < CertificateProfile.AVAILABLE_MSTEMPLATES.length;i++){ %>
                  <option  value="<%= CertificateProfile.AVAILABLE_MSTEMPLATES[i] %>" 
              <% 
                   if(CertificateProfile.AVAILABLE_MSTEMPLATES[i] == cpd.getMicrosoftTemplate() ) out.write(" selected "); %>> 
              <%=  CertificateProfile.AVAILABLE_MSTEMPLATES[i] %>
                  </option>
           <%   } %> 
           </select>
           <br />
           <p class="help">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
           <c:out value="<%= ejbcawebbean.getText(\"EXT_MS_TEMPLATENAME_HELP\") %>" /></p>
      </td>
    </tr>

    <%-- SEIS Card Number extension --%>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_SEIS_CARDNUMBER\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#Cardnumber") %>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USECARDNUMBER %>"  value="<%=CB_VALUE %>" 
           <% if(cpd.getUseCardNumber())
                 out.write("CHECKED");
           %> id="<%=CB_USECARDNUMBER%>">
           <label for="<%=CB_USECARDNUMBER%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>    


    <%-- CVC --%>

    <tr  id="Row<%=row%2%>" class="section">
          <td width="50%"  align="right">
        <strong><c:out value="<%= ejbcawebbean.getText(\"CVCEPASSPORT\") %>" /></strong>
      </td>
      <td width="50%">
        &nbsp;
      </td>
    </tr>
    
    <tr  id="Row<%=row%2%>">
      <td width="50%" align="right">
        <c:out value="<%= ejbcawebbean.getText(\"CVCTERMTYPE\") %>" />
      </td>
      <td width="50%">
        <select name="<%=SELECT_CVCTERMTYPE%>" size="1" onclick="cvctermtypechanged();" onchange="cvctermtypechanged();" onkeyup="cvctermtypechanged();">
           <%  int termtype = cpd.getCVCTerminalType(); %>
           <option  value="<%=CertificateProfile.CVC_TERMTYPE_IS%>"
                 <% if (termtype == CertificateProfile.CVC_TERMTYPE_IS ) out.write(" selected "); %>>
                <c:out value="<%= ejbcawebbean.getText(\"CVCINSPECTIONSYSTEM\") %>" />
           </option>
           <option  value="<%=CertificateProfile.CVC_TERMTYPE_AT%>"
                 <% if (termtype == CertificateProfile.CVC_TERMTYPE_AT ) out.write(" selected "); %>>
                <c:out value="<%= ejbcawebbean.getText(\"CVCAUTHENTICATIONTERMINAL\") %>" />
           </option>
           <option  value="<%=CertificateProfile.CVC_TERMTYPE_ST%>"
                 <% if (termtype == CertificateProfile.CVC_TERMTYPE_ST ) out.write(" selected "); %>>
                <c:out value="<%= ejbcawebbean.getText(\"CVCSIGNATURETERMINAL\") %>" />
           </option>
        </select>
      </td>
    </tr>
    
    <tr  id="Row<%=row++%2%>">
      <td width="50%" align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"CVCSIGNTERMDVTYPE\") %>" />
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_CVCSIGNTERMDVTYPE%>" size="1" >
           <%  int signdvtype = cpd.getCVCSignTermDVType(); %>
           <option  value="<%=CertificateProfile.CVC_SIGNTERM_DV_AB%>"
                 <% if (signdvtype == CertificateProfile.CVC_SIGNTERM_DV_AB ) out.write(" selected "); %>>
                <c:out value="<%= ejbcawebbean.getText(\"CVCACCREDITATIONBODY\") %>" />
           </option>
           <option  value="<%=CertificateProfile.CVC_SIGNTERM_DV_CSP%>"
                 <% if (signdvtype == CertificateProfile.CVC_SIGNTERM_DV_CSP ) out.write(" selected "); %>>
                <c:out value="<%= ejbcawebbean.getText(\"CVCCERTIFICATIONSERVICEPROVIDER\") %>" />
           </option>
        </select>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>">
      <td width="50%" align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"CVCACCESSRIGHTS\") %>" />
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_CVCACCESSRIGHTS%>" multiple="multiple" size="8">
           <%
           int ar = cpd.getCVCAccessRights();
           byte[] arl = cpd.getCVCLongAccessRights();
           if (arl == null) arl = CertificateProfile.DEFAULT_CVC_RIGHTS_AT;
           AccessRightAuthTerm arlflags;
           try {
               arlflags = new AccessRightAuthTerm(arl);
           } catch (IllegalArgumentException e) {
               // zero-length array or other error
               arlflags = new AccessRightAuthTerm();
           }
           %>
           
           <%-- Inspection Systems --%>
           <option disabled="disabled" class="cvcoption_header"> 
                <c:out value="<%= ejbcawebbean.getText(\"CVCINSPECTIONSYSTEM\") %>" />
           </option>
           <option value="<%=CertificateProfile.CVC_ACCESS_DG3%>" <% if ((ar & CertificateProfile.CVC_ACCESS_DG3) != 0) out.write(" selected "); %> class="cvcoption_is"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSDG3\") %>" /></option>
           <option value="<%=CertificateProfile.CVC_ACCESS_DG4%>" <% if ((ar & CertificateProfile.CVC_ACCESS_DG4) != 0) out.write(" selected "); %> class="cvcoption_is"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSDG4\") %>" /></option>
           
           <%-- Authentication Terminals --%>
           <option disabled="disabled" class="cvcoption_header"> 
                <c:out value="<%= ejbcawebbean.getText(\"CVCAUTHENTICATIONTERMINAL\") %>" />
           </option>
           <option value="0" <% if (arlflags.getFlag(0)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSAGEVERIFICATION\") %>" /></option>
           <option value="1" <% if (arlflags.getFlag(1)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSCOMMUNITYIDVERIFICATION\") %>" /></option>
           <option value="2" <% if (arlflags.getFlag(2)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSRESTRICTEDIDENTIFICATION\") %>" /></option>
           <option value="3" <% if (arlflags.getFlag(3)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSPRIVILEGEDTERMINAL\") %>" /></option>
           <option value="4" <% if (arlflags.getFlag(4)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSCANALLOWED\") %>" /></option>
           <option value="5" <% if (arlflags.getFlag(5)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSPINMANAGEMENT\") %>" /></option>
           <option value="6" <% if (arlflags.getFlag(6)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSINSTALLCERT\") %>" /></option>
           <option value="7" <% if (arlflags.getFlag(7)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSINSTALLQUALIFIEDCERT\") %>" /></option>
           
           <%
           String writeDGFormat = ejbcawebbean.getText("CVCACCESSWRITEDG");
           String readDGFormat = ejbcawebbean.getText("CVCACCESSREADDG");
           %>
           <% for (int i = 8; i <= 28; i++) { %>
               <option value="<%= i %>" <% if (arlflags.getFlag(i)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= MessageFormat.format(readDGFormat, i-8+1) %>" /></option>
          <% } %> 
           
          <option value="37" <% if (arlflags.getFlag(37)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= MessageFormat.format(writeDGFormat, 17) %>" /></option>
          <option value="36" <% if (arlflags.getFlag(36)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= MessageFormat.format(writeDGFormat, 18) %>" /></option>
          <option value="35" <% if (arlflags.getFlag(35)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= MessageFormat.format(writeDGFormat, 19) %>" /></option>
          <option value="34" <% if (arlflags.getFlag(34)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= MessageFormat.format(writeDGFormat, 20) %>" /></option>
          <option value="33" <% if (arlflags.getFlag(33)) out.write(" selected "); %> class="cvcoption_at"><c:out value="<%= MessageFormat.format(writeDGFormat, 21) %>" /></option>
          
           
           <%-- Signature Terminals --%>
           <option disabled="disabled" class="cvcoption_header"> 
                <c:out value="<%= ejbcawebbean.getText(\"CVCSIGNATURETERMINAL\") %>" />
           </option>
           <option value="<%=CertificateProfile.CVC_ACCESS_SIGN%>" <% if ((ar & CertificateProfile.CVC_ACCESS_SIGN) != 0) out.write(" selected "); %> class="cvcoption_st"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSSIGN\") %>" /></option>
           <option value="<%=CertificateProfile.CVC_ACCESS_QUALSIGN%>" <% if ((ar & CertificateProfile.CVC_ACCESS_QUALSIGN) != 0) out.write(" selected "); %> class="cvcoption_st"><c:out value="<%= ejbcawebbean.getText(\"CVCACCESSQUALSIGN\") %>" /></option>
        </select>
      </td>
    </tr>
    <script type="text/javascript">
    cvctermtypechanged();
    </script>



    <%-- Other data --%>

    <tr  id="Row<%=row%2%>" class="section">
 	      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"OTHERDATA\") %>" /></strong>
      </td>
      <td width="50%"> 
        &nbsp;
      </td>
    </tr>

    <tr id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <strong><c:out value="<%= ejbcawebbean.getText(\"CERT_SUBJECTDN_LDAPORDER\") %>" /></strong> <%= ejbcawebbean.getHelpReference("/userguide.html#Use%20LDAP%20DN%20order") %>
      </td>
      <td width="50%"> 
        <input type="checkbox" name="<%=CB_USELDAPDNORDER %>" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseLdapDnOrder())
                 out.write("CHECKED");
           %> id="<%=CB_USELDAPDNORDER%>">
           <label for="<%=CB_USELDAPDNORDER%>"><c:out value="<%= ejbcawebbean.getText(\"USE\") %>" /></label>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"CERT_SUBJECTDN_CNPOSTFIX\") %>" /> 
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USECNPOSTFIX  %>"  onclick="checkusecnpostfixfield()" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseCNPostfix())
                 out.write("CHECKED");
           %> id="<%=CB_USECNPOSTFIX%>">
  CB <label for="<%=CB_USECNPOSTFIX%>"><c:out value="<%= ejbcawebbean.getText(\"ADD\") %>" /></label>
           :&nbsp;
           <c:out value="<%= ejbcawebbean.getText(\"VALUE\") %>" />
           <input type="text" name="<%=TEXTFIELD_CNPOSTFIX%>" size="20" maxlength="255" title="<%= ejbcawebbean.getText("FORMAT_STRING") %>"
           <%       if(!cpd.getUseCNPostfix()) {
                      out.write(" disabled "); 
                    } else {%> 
                      value="<c:out value="<%= cpd.getCNPostfix() %>"/>"
                    <%}%> >
           <br />
           <p class="help">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
           <c:out value="<%= ejbcawebbean.getText(\"CERT_SUBJECTDN_CNPF_HELP\") %>" /></p>
      </td>
    </tr>

    <tr  id="Row<%=row%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"CERT_SUBJECTDN_SUBSET\") %>" /> <%= ejbcawebbean.getHelpReference("/userguide.html#Subset%20of%20Subject%20DN") %>
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USESUBJECTDNSUBSET  %>"  onclick="checkusesubjectdnsubsetfield()" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseSubjectDNSubSet())
                 out.write("CHECKED");
           %> id="<%=CB_USESUBJECTDNSUBSET%>">
           <label for="<%=CB_USESUBJECTDNSUBSET%>"><c:out value="<%= ejbcawebbean.getText(\"RESTRICT\") %>" /></label>
      </td>
    </tr>        
    <tr id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"> 
          &nbsp;
      </td>
      <td width="50%" valign="top">   
        <select name="<%=SELECT_SUBJECTDNSUBSET%>" size="10" multiple <%if(!cpd.getUseSubjectDNSubSet()){out.write(" disabled ");} %>>       
            <% HashSet currentfields = new HashSet(cpd.getSubjectDNSubSet());
               Integer[] usefieldsindn = DNFieldExtractor.getUseFields(DNFieldExtractor.TYPE_SUBJECTDN);
               String[] usefieldsindntexts = (String[])DnComponents.getDnLanguageTexts().toArray(new String[0]);
               for(int i=0;i < usefieldsindn.length; i++){ %>                                  
              <option value="<%=usefieldsindn[i]%>" <% if(currentfields.contains(usefieldsindn[i])) out.write(" selected "); %>> 
                  <c:out value="<%= ejbcawebbean.getText(usefieldsindntexts[i]) %>" />
               </option>
            <%}%>
          </select>         
      </td>
    </tr>

    <tr  id="Row<%=row%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"EXT_PKIX_SAN_SUBSET\") %>" /> 
      </td>
      <td width="50%">
           <input type="checkbox" name="<%=CB_USESUBJECTALTNAMESUBSET  %>"  onclick="checkusesubjectaltnamesubsetfield()" value="<%=CB_VALUE %>" 
           <% if(cpd.getUseSubjectAltNameSubSet())
                 out.write("CHECKED");
           %> id="<%=CB_USESUBJECTALTNAMESUBSET%>">
           <label for="<%=CB_USESUBJECTALTNAMESUBSET%>"><c:out value="<%= ejbcawebbean.getText(\"RESTRICT\") %>" /></label>
      </td>
    </tr>        
    <tr id="Row<%=row++%2%>"> 
      <td width="50%" valign="top" align="right"> 
          &nbsp;
      </td>
      <td width="50%" valign="top">   
        <select name="<%=SELECT_SUBJECTALTNAMESUBSET%>" size="6" multiple <%if(!cpd.getUseSubjectAltNameSubSet()){out.write(" disabled ");} %>>       
            <% currentfields = new HashSet(cpd.getSubjectAltNameSubSet());
               Integer[] usefieldsinaltname = DNFieldExtractor.getUseFields(DNFieldExtractor.TYPE_SUBJECTALTNAME);
               String[] usefieldsinaltnametexts = (String[])DnComponents.getAltNameLanguageTexts().toArray(new String[0]);
               for(int i=0;i < usefieldsinaltname.length; i++){ %>                                  
              <option value="<%=usefieldsinaltname[i]%>" <% if(currentfields.contains(usefieldsinaltname[i])) out.write(" selected "); %>> 
                  <c:out value="<%= ejbcawebbean.getText(usefieldsinaltnametexts[i]) %>" />
               </option>
            <%}%>
          </select>         
      </td>
    </tr>

    <% if(certExtFact.getAvailableCertificateExtensions().size() > 0){ %>
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"USEDCERTEXTENSIONS\") %>" />
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_USEDCERTIFICATEEXTENSIONS%>" size="5" multiple >
           <%  List usedCertExt = cpd.getUsedCertificateExtensions();               
               List availableCertExt = certExtFact.getAvailableCertificateExtensions();
               for(int i=0; i<availableCertExt.size();i++){ 
                 AvailableCertificateExtension availCertExt = (AvailableCertificateExtension) availableCertExt.get(i); %>
           <option  value="<%= availCertExt.getId() %>" 
              <%  if(usedCertExt.contains(Integer.valueOf(availCertExt.getId()))){
                      out.write(" selected ");
                  }%>>
              <% if(availCertExt.isTranslatable()){ 
                 out.write(ejbcawebbean.getText(availCertExt.getDisplayName()));              
              }else{
                  out.write(availCertExt.getDisplayName());  
              } %>         
           </option>  
              <% } %>
        </select>
      </td>
    </tr>   
    <% } %>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"AVAILABLECAS\") %>" />
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_AVAILABLECAS%>" size="7" multiple >
           <% Collection usedcas = cpd.getAvailableCAs(); 
              if(issuperadministrator){ %>
           <option  value="<%= CertificateProfile.ANYCA %>" 
              <% if(usedcas.contains(Integer.valueOf(CertificateProfile.ANYCA)))
                   out.write(" selected ");%>>
              <c:out value="<%= ejbcawebbean.getText(\"ANYCA\") %>" />         
           </option>      
           <%   }
                Iterator iter = authorizedcas.iterator(); 
                while(iter.hasNext()){
                  Integer next = (Integer) iter.next(); %>
           <option  value="<%= next.intValue() %>" 
              <%    if(usedcas.contains(next))
                      out.write(" selected ");
                  %>>
              <c:out value="<%= caidtonamemap.get(next) %>"/>
           </option>  
              <% } %>
        </select>
      </td>
    </tr>

    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"PUBLISHERS\") %>" />
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_AVAILABLEPUBLISHERS%>" size="5"
        	multiple  <% if(cpd.getType() != CertificateConstants.CERTTYPE_ENDENTITY)
        					out.write(" disabled "); %>>
           <%   Collection usedpublishers = cpd.getPublisherList(); 
                iter = authorizedpublishers.keySet().iterator(); 
                while(iter.hasNext()){
                  String next = (String) iter.next(); 
                  Integer nextid = (Integer) authorizedpublishers.get(next); %>
           <option  value="<%= nextid %>" 
              <%    if(usedpublishers.contains(nextid))
                      out.write(" selected ");
                  %>>
              <c:out value="<%= next %>"/>
           </option>  
              <% } %>
        </select>
      </td>
    </tr>

    <tr id="Row<%=row%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"APPROVALSETTINGS\") %>" /> 
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_APPROVALSETTINGS%>" size="5" multiple>
           <%                   
                for(int i=0;i< CAInfo.AVAILABLE_APPROVALSETTINGS.length;i++){
                   %>
           <option  value="<%= CAInfo.AVAILABLE_APPROVALSETTINGS[i] %>" 
              <%    if(cpd.isApprovalRequired(CAInfo.AVAILABLE_APPROVALSETTINGS[i]))
                      out.write(" selected ");
                  %>>
              <c:out value="<%= ejbcawebbean.getText(CAInfo.AVAILABLE_APPROVALSETTINGS_TEXTS[i]) %>" />         
           </option>  
              <% } %>
        </select>        
      </td>
    </tr>
    <tr id="Row<%=row++%2%>"> 
      <td width="50%"  align="right"> 
        <c:out value="<%= ejbcawebbean.getText(\"NUMOFREQUIREDAPPROVALS\") %>" />
      </td>
      <td width="50%"> 
        <select name="<%=SELECT_NUMOFREQUIREDAPPROVALS%>" >
           <%  for(int i=1;i<= 4;i++){
                   %>
           <option  value="<%= i %>" 
              <%    if(cpd.getNumOfReqApprovals() == i)
                      out.write(" selected ");
                  %>>
              <%= i %>         
           </option>  
              <% } %>
        </select>        
      </td>
    </tr>


	<%-- Form buttons --%>
	
    <tr  id="Row<%=row++%2%>"> 
      <td width="50%" valign="top">
        &nbsp;
      </td>
      <td width="50%" valign="top"> 
        <input type="submit" name="<%= BUTTON_SAVE %>" onClick='return checkallfields()' value="<%= ejbcawebbean.getText("SAVE") %>">
        &nbsp;&nbsp;&nbsp;
        <input type="submit" name="<%= BUTTON_CANCEL %>" value="<%= ejbcawebbean.getText("CANCEL") %>">
      </td>
    </tr>

  </table>
 </form>
